<!DOCTYPE html><head><meta charset="UTF-8"><title>Building all Dependencies from Source | Gnat</title><link href="../contrib/materialize/materialize.min.css" type="text/css" rel="stylesheet" media="screen,projection"></link><link href="../contrib/prism/prism.min.css" type="text/css" rel="stylesheet"></link><link href="../css/moose.css" type="text/css" rel="stylesheet"></link><link href="../css/devel_moose.css" type="text/css" rel="stylesheet"></link><link href="../css/alert_moose.css" type="text/css" rel="stylesheet"></link><link href="../css/content_moose.css" type="text/css" rel="stylesheet"></link><link href="../css/sqa_moose.css" type="text/css" rel="stylesheet"></link><link href="../css/civet_moose.css" type="text/css" rel="stylesheet"></link><script type="text/javascript" src="../contrib/jquery/jquery.min.js"></script></head><body><div class="page-wrap"><header><nav><div class="nav-wrapper container"><a href="../index.html" class="left moose-logo hide-on-med-and-down" id="home-button">Gnat</a><a href="https://github.com/OTU-Center-for-SMRs/gnat" class="right"><img src="../media/framework/github-logo.png" class="github-mark"></img><img src="../media/framework/github-mark.png" class="github-logo"></img></a><ul class="right hide-on-med-and-down"><li><a href="#!" class="dropdown-trigger" data-target="1d95955f-3315-44f5-a850-7372ac82c910" data-constrainWidth="false">Getting Started<i class="material-icons right">arrow_drop_down</i></a></li><li><a href="#!" class="dropdown-trigger" data-target="3b2f3fe4-3fd2-4cd7-af70-0701ebc3ebc4" data-constrainWidth="false">Theory and Implementation<i class="material-icons right">arrow_drop_down</i></a></li><li><a href="#!" class="dropdown-trigger" data-target="52867dd4-3bae-480e-9b61-d02d25b98854" data-constrainWidth="false">Documentation<i class="material-icons right">arrow_drop_down</i></a></li><li><a href="../publications.html">Publications</a></li><li><a href="../contact.html">Contact</a></li></ul><a href="#" class="sidenav-trigger" data-target="08dcdfae-8e79-41ea-b3a5-b7959564ae09"><i class="material-icons">menu</i></a><ul class="sidenav" id="08dcdfae-8e79-41ea-b3a5-b7959564ae09"><li><a href="#!" class="dropdown-trigger" data-target="7ea1866b-4298-48d3-b172-dd12e0ea45bc" data-constrainWidth="false">Getting Started<i class="material-icons right">arrow_drop_down</i></a></li><li><a href="#!" class="dropdown-trigger" data-target="fbdb55d9-fb59-49c9-bbd9-46269f1869a3" data-constrainWidth="false">Theory and Implementation<i class="material-icons right">arrow_drop_down</i></a></li><li><a href="#!" class="dropdown-trigger" data-target="c6558273-0564-4914-8556-9c5fd12c9720" data-constrainWidth="false">Documentation<i class="material-icons right">arrow_drop_down</i></a></li><li><a href="../publications.html">Publications</a></li><li><a href="../contact.html">Contact</a></li></ul><a href="#moose-search" class="modal-trigger"><i class="material-icons">search</i></a></div><ul class="dropdown-content" id="1d95955f-3315-44f5-a850-7372ac82c910"><li><a href="index.html">Installation</a></li><li><a href="../tutorials/index.html">Tutorials</a></li></ul><ul class="dropdown-content" id="3b2f3fe4-3fd2-4cd7-af70-0701ebc3ebc4"><li><a href="../about/radiation_transport.html">Radiation Transport</a></li><li><a href="../about/mobile_depletion.html">Fluid Depletion</a></li><li><a href="../about/implementation.html">Implementation</a></li></ul><ul class="dropdown-content" id="52867dd4-3bae-480e-9b61-d02d25b98854"><li><a href="../source/index.html">Gnat Source Pages</a></li><li><a href="https://mooseframework.inl.gov/source/index.html">MOOSE Source Pages</a></li></ul><ul class="dropdown-content" id="7ea1866b-4298-48d3-b172-dd12e0ea45bc"><li><a href="index.html">Installation</a></li><li><a href="../tutorials/index.html">Tutorials</a></li></ul><ul class="dropdown-content" id="fbdb55d9-fb59-49c9-bbd9-46269f1869a3"><li><a href="../about/radiation_transport.html">Radiation Transport</a></li><li><a href="../about/mobile_depletion.html">Fluid Depletion</a></li><li><a href="../about/implementation.html">Implementation</a></li></ul><ul class="dropdown-content" id="c6558273-0564-4914-8556-9c5fd12c9720"><li><a href="../source/index.html">Gnat Source Pages</a></li><li><a href="https://mooseframework.inl.gov/source/index.html">MOOSE Source Pages</a></li></ul></nav><div class="modal modal-fixed-footer moose-search-modal" id="moose-search"><div class="modal-content container moose-search-modal-content"><div class="row"><div class="col l12"><div class="input-field"><input type_="text" onkeyup="mooseSearch()" placeholder="/index.md" id="moose-search-box"></input></div></div><div><div class="col s12" id="moose-search-results"></div></div></div></div><div class="modal-footer"><a href="#!" class="modal-close btn-flat">Close</a></div></div></header><main class="main"><div class="container"><div class="row"><div class="col hide-on-med-and-down l12"><nav class="breadcrumb-nav"><div class="nav-wrapper"><a href="." class="breadcrumb">installation</a><a href="#" class="breadcrumb">from_source</a></div></nav></div></div><div class="row"><div class="moose-content col s12 m12 l10"><section id="daaa2c8e-ee13-42c3-a140-9d4c0d4ea2fa" data-section-level="1" data-section-text="Building all Dependencies from Source"><h1 id="building-all-dependencies-from-source">Building all Dependencies from Source</h1><div class="card moose-alert moose-alert-note"><div class="card-title moose-alert-title"><i class="material-icons moose-inline-icon">comment</i><span class="moose-alert-title-brand">note:</span>tldr</div><div class="card-content"><div class="moose-alert-content"><p>All that you need to compile Gnat is:</p><pre class="moose-pre"><code class="language-text">
cd $HOME
git clone https://github.com/OTU-Center-for-SMRs/gnat.git
cd gnat
git submodule update --init
./moose/scripts/update_and_rebuild_petsc.sh
./moose/scripts/update_and_rebuild_libmesh.sh
./moose/scripts/update_and_rebuild_wasp.sh
make -j{NUM_PROCESSES}
</code></pre><p>If the above produces a <code>gnat-opt</code> executable, you can jump straight to <a href="from_source.html#running">5. Run Simulations</a>. If you were not successful with the above, please consult the detailed instructions that follow. </p></div></div></div><section class="scrollspy" id="bc6429eb-940f-4c5e-9f85-a6fb4e3f9ce1" data-section-level="2" data-section-text="1 . Cloning Gnat and MOOSE"><h2 id="1-cloning-gnat-and-moose">1. Cloning Gnat and MOOSE</h2><p>When building Gnat and the entire dependency chain from source we recommend that you use the MOOSE submodule included with Gnat to minimize the possibility for build errors. Gnat and it&#x27;s MOOSE submodule can be obtained with the following:</p><pre class="moose-pre"><code class="language-bash">
git clone https://github.com/OTU-Center-for-SMRs/gnat.git
cd gnat
git submodule update --init moose
git submodule update --init include/utils/nuclear_data
</code></pre><p>Once the repository has been cloned, proceed to the next step.</p></section><section class="scrollspy" id="d6bac4b5-c2ab-4c17-84ef-0c414cf80abe" data-section-level="2" data-section-text="2 . Getting Cardinal"><h2 id="2-getting-cardinal">2. Getting Cardinal</h2><p>Gnat allows for neutronics coupling with the continuous-energy Monte Carlo code <a href="https://github.com/openmc-dev/openmc">OpenMC</a> through <a href="https://github.com/neams-th-coe/cardinal">Cardinal</a>. If you don&#x27;t want to build with Cardinal, you can skip this step. If you want to build Gnat with Cardinal, you need to update the Cardinal submodule and fetch it&#x27;s dependencies:</p><pre class="moose-pre"><code class="language-bash">
git submodule update --init cardinal
./cardinal/scripts/get-dependencies.sh
</code></pre><p>In addition to fetching Cardinal&#x27;s dependencies, you&#x27;ll need to export a few environment variables:</p><pre class="moose-pre"><code class="language-bash">
# [REQUIRED] for builds with Cardinal
export ENABLE_CARDINAL=yes

# [OPTIONAL] it&#x27;s a good idea to explicitly note that you are using MPI compiler wrappers
export CC=mpicc
export CXX=mpicxx
export FC=mpif90

# [REQUIRED WHEN RUNNING OPENMC] you will need cross section data at runtime;
# ythis variable must be set to point to a &#x27;cross_sections.xml&#x27; file.
export OPENMC_CROSS_SECTIONS=${HOME}/cross_sections/endfb-vii.1-hdf5/cross_sections.xml
</code></pre></section><section class="scrollspy" id="dcfd8156-45e2-49d1-9229-f4afab32cda3" data-section-level="2" data-section-text="3 . Building MOOSE ' s Dependencies"><h2 id="3-building-moose-s-dependencies">3. Building MOOSE&#x27;s Dependencies</h2><p>From here, you need to build all of MOOSE&#x27;s dependencies. Before proceeding, please ensure that your system meets <a href="https://mooseframework.inl.gov/getting_started/installation/index.html">MOOSE&#x27;s minimum requirements </a>. If you&#x27;re missing any of these packages, stop and install them first. The most common build errors are caused by missing the python packages <code>packaging</code> and <code>pyaml</code>. Next, you will need to set a few environment variables to ensure the build proceeds smoothly:</p><pre class="moose-pre"><code class="language-bash">
export CC=mpicc
export CXX=mpicxx
export FC=mpif90
export F77=mpif77
export F90=mpif90
</code></pre><p>From here, we need to build PETSc, libMesh, and WASP. This is done with a series of shell scripts provided by MOOSE:</p><pre class="moose-pre"><code class="language-bash">
./moose/scripts/update_and_rebuild_petsc.sh
./moose/scripts/update_and_rebuild_libmesh.sh
./moose/scripts/update_and_rebuild_wasp.sh
</code></pre><p>If you encounter any errors at this stage, feel free to post the build errors on the Gnat discussion forums.</p><div class="card moose-alert moose-alert-tip"><div class="card-title moose-alert-title"><i class="material-icons moose-inline-icon">school</i><span class="moose-alert-title-brand">tip:</span>Building in parallel.</div><div class="card-content"><div class="moose-alert-content"><p>By default, the scripts provided by MOOSE will build in serial. To speed up the build process, export the following environment variables:</p><pre class="moose-pre"><code class="language-bash">
export JOBS={NUM_PROCESSES}
export MOOSE_JOBS={NUM_PROCESSES}
export LIBMESH_JOBS={NUM_PROCESSES}
</code></pre><p>where <code>{NUM_PROCESSES}</code> is the number of processes you wish to use when building.</p><p></p></div></div></div></section><section class="scrollspy" id="c3d811fb-f1b0-459d-af4b-5cc3d8a2cf4f" data-section-level="2" data-section-text="4 . Compile Gnat"><h2 id="4-compile-gnat">4. Compile Gnat</h2><p>At this point all of MOOSE&#x27;s dependencies have been compiled, and you&#x27;re ready to build Gnat (with or without Cardinal) and MOOSE using the <code>make</code> buildsystem:</p><pre class="moose-pre"><code class="language-bash">
make -j{NUM_PROCESSES}
</code></pre><p>where <code>{NUM_PROCESSES}</code> is the number of concurrent processes you want building both Gnat and the MOOSE framework. You may also compile a debug version of Gnat by running <code>METHOD=dbg make
-j{NUM_PROCESSES}</code>.</p><p>Finally, run all tests to ensure that Gnat has been built successfully:</p><pre class="moose-pre"><code class="language-bash">
./run_tests -j{NUM_THREADS}
</code></pre><p>Where <code>{NUM_THREADS}</code> is the number of threads you want running tests.</p></section><section class="scrollspy" id="043c715f-2dc4-4d9d-a182-f04a65a30ed4" data-section-level="2" data-section-text="5 . Run Simulations"><h2 id="running">5. Run Simulations</h2><p>Gnat simulations use the hierarchical input text (HIT) input deck specification designed by INL for MOOSE-based applications. More information about HIT syntax can be found in the <a href="https://mooseframework.inl.gov/getting_started/examples_and_tutorials/tutorial01_app_development/step02_input_file.html#step-2-write-an-input-file">MOOSE tutorials</a>. Gnat input decks can be executed with the following shell command:</p><pre class="moose-pre"><code class="language-bash">
./gnat-opt -i input-file.i
</code></pre><p>Replace <code>input-file.i</code> with the name of your input file. Gnat can be executed in parallel using MPI and the following shell command:</p><pre class="moose-pre"><code class="language-bash">
mpirun -n{NUM_THREADS} ./gnat-opt -i input-file.i
</code></pre><p>Where <code>{NUM_THREADS}</code> is the number of threads you want executing the input deck.</p><p>Now that Gnat has been successfully installed and tested, feel free to check out the <a href="../tutorials/index.html">tutorials</a> to learn how to write a Gnat input deck. </p></section></section></div><div class="col hide-on-med-and-down l2"><div class="toc-wrapper pin-top"><ul class="section table-of-contents"><li><a href="#bc6429eb-940f-4c5e-9f85-a6fb4e3f9ce1" class="tooltipped" data-position="left" data-tooltip="1 . Cloning Gnat and MOOSE">1 . Cloning Gnat and MOOSE</a></li><li><a href="#d6bac4b5-c2ab-4c17-84ef-0c414cf80abe" class="tooltipped" data-position="left" data-tooltip="2 . Getting Cardinal">2 . Getting Cardinal</a></li><li><a href="#dcfd8156-45e2-49d1-9229-f4afab32cda3" class="tooltipped" data-position="left" data-tooltip="3 . Building MOOSE ' s Dependencies">3 . Building MOOSE ' s Dependencies</a></li><li><a href="#c3d811fb-f1b0-459d-af4b-5cc3d8a2cf4f" class="tooltipped" data-position="left" data-tooltip="4 . Compile Gnat">4 . Compile Gnat</a></li><li><a href="#043c715f-2dc4-4d9d-a182-f04a65a30ed4" class="tooltipped" data-position="left" data-tooltip="5 . Run Simulations">5 . Run Simulations</a></li></ul></div></div></div></div></main></div></body><script type="text/javascript" src="../contrib/materialize/materialize.min.js"></script><script type="text/javascript" src="../contrib/clipboard/clipboard.min.js"></script><script type="text/javascript" src="../contrib/prism/prism.min.js"></script><script type="text/javascript" src="../js/init.js"></script><script type="text/javascript" src="../js/navigation.js"></script><script type="text/javascript" src="../contrib/fuse/fuse.min.js"></script><script type="text/javascript" src="../js/search_index.js"></script><script type="text/javascript" src="../js/sqa_moose.js"></script>
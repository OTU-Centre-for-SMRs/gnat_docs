<!DOCTYPE html><head><meta charset="UTF-8"><title>Modelling the Kobayashi Benchmark Problems | Gnat</title><link href="../contrib/materialize/materialize.min.css" type="text/css" rel="stylesheet" media="screen,projection"></link><link href="../contrib/prism/prism.min.css" type="text/css" rel="stylesheet"></link><link href="../css/moose.css" type="text/css" rel="stylesheet"></link><link href="../css/devel_moose.css" type="text/css" rel="stylesheet"></link><link href="../css/alert_moose.css" type="text/css" rel="stylesheet"></link><link href="../css/content_moose.css" type="text/css" rel="stylesheet"></link><link href="../css/sqa_moose.css" type="text/css" rel="stylesheet"></link><link href="../css/civet_moose.css" type="text/css" rel="stylesheet"></link><link href="../contrib/katex/katex.min.css" type="text/css" rel="stylesheet"></link><link href="../css/katex_moose.css" type="text/css" rel="stylesheet"></link><script type="text/javascript" src="../contrib/jquery/jquery.min.js"></script><script type="text/javascript" src="../contrib/katex/katex.min.js"></script></head><body><div class="page-wrap"><header><nav><div class="nav-wrapper container"><a href="../index.html" class="left moose-logo hide-on-med-and-down" id="home-button">Gnat</a><a href="https://github.com/OTU-Center-for-SMRs/gnat" class="right"><img src="../media/framework/github-logo.png" class="github-mark"></img><img src="../media/framework/github-mark.png" class="github-logo"></img></a><ul class="right hide-on-med-and-down"><li><a href="#!" class="dropdown-trigger" data-target="85385d44-c17d-4593-aad0-fe44ac7b5caa" data-constrainWidth="false">Getting Started<i class="material-icons right">arrow_drop_down</i></a></li><li><a href="#!" class="dropdown-trigger" data-target="4f3f03ea-558b-4417-954c-6784e82b914f" data-constrainWidth="false">Theory and Implementation<i class="material-icons right">arrow_drop_down</i></a></li><li><a href="#!" class="dropdown-trigger" data-target="36d35757-aa9e-4fdd-b778-68925292916c" data-constrainWidth="false">Documentation<i class="material-icons right">arrow_drop_down</i></a></li><li><a href="../publications.html">Publications</a></li><li><a href="../contact.html">Contact</a></li></ul><a href="#" class="sidenav-trigger" data-target="85984078-e1d8-41fa-b8a7-f0f77ffcf63a"><i class="material-icons">menu</i></a><ul class="sidenav" id="85984078-e1d8-41fa-b8a7-f0f77ffcf63a"><li><a href="#!" class="dropdown-trigger" data-target="d28601c5-aa51-4709-851c-78930a0e35cb" data-constrainWidth="false">Getting Started<i class="material-icons right">arrow_drop_down</i></a></li><li><a href="#!" class="dropdown-trigger" data-target="b6a4a19c-6b1d-4fb7-be0e-f82bb2f6b59b" data-constrainWidth="false">Theory and Implementation<i class="material-icons right">arrow_drop_down</i></a></li><li><a href="#!" class="dropdown-trigger" data-target="15efafc7-96db-4827-961d-9ea7ab2f040f" data-constrainWidth="false">Documentation<i class="material-icons right">arrow_drop_down</i></a></li><li><a href="../publications.html">Publications</a></li><li><a href="../contact.html">Contact</a></li></ul><a href="#moose-search" class="modal-trigger"><i class="material-icons">search</i></a></div><ul class="dropdown-content" id="85385d44-c17d-4593-aad0-fe44ac7b5caa"><li><a href="../installation/index.html">Installation</a></li><li><a href="index.html">Tutorials</a></li></ul><ul class="dropdown-content" id="4f3f03ea-558b-4417-954c-6784e82b914f"><li><a href="../about/radiation_transport.html">Radiation Transport</a></li><li><a href="../about/mobile_depletion.html">Fluid Depletion</a></li><li><a href="../about/implementation.html">Implementation</a></li></ul><ul class="dropdown-content" id="36d35757-aa9e-4fdd-b778-68925292916c"><li><a href="../source/index.html">Gnat Source Pages</a></li><li><a href="https://mooseframework.inl.gov/source/index.html">MOOSE Source Pages</a></li></ul><ul class="dropdown-content" id="d28601c5-aa51-4709-851c-78930a0e35cb"><li><a href="../installation/index.html">Installation</a></li><li><a href="index.html">Tutorials</a></li></ul><ul class="dropdown-content" id="b6a4a19c-6b1d-4fb7-be0e-f82bb2f6b59b"><li><a href="../about/radiation_transport.html">Radiation Transport</a></li><li><a href="../about/mobile_depletion.html">Fluid Depletion</a></li><li><a href="../about/implementation.html">Implementation</a></li></ul><ul class="dropdown-content" id="15efafc7-96db-4827-961d-9ea7ab2f040f"><li><a href="../source/index.html">Gnat Source Pages</a></li><li><a href="https://mooseframework.inl.gov/source/index.html">MOOSE Source Pages</a></li></ul></nav><div class="modal modal-fixed-footer moose-search-modal" id="moose-search"><div class="modal-content container moose-search-modal-content"><div class="row"><div class="col l12"><div class="input-field"><input type_="text" onkeyup="mooseSearch()" placeholder="/index.md" id="moose-search-box"></input></div></div><div><div class="col s12" id="moose-search-results"></div></div></div></div><div class="modal-footer"><a href="#!" class="modal-close btn-flat">Close</a></div></div></header><main class="main"><div class="container"><div class="row"><div class="col hide-on-med-and-down l12"><nav class="breadcrumb-nav"><div class="nav-wrapper"><a href="." class="breadcrumb">tutorials</a><a href="#" class="breadcrumb">3D_kobayashi</a></div></nav></div></div><div class="row"><div class="moose-content col s12 m12 l10"><section id="7714fbd5-7be7-4217-bdac-372169b38969" data-section-level="1" data-section-text="Modelling the Kobayashi Benchmark Problems"><h1 id="modelling-the-kobayashi-benchmark-problems">Modelling the Kobayashi Benchmark Problems</h1><p>In this tutorial, you will learn how to model more complicated 3D fixed source problems in <a href="#kobayashi">Kobayashi et al. (2001)</a> with Gnat. To access this tutorial,</p><pre class="moose-pre"><code class="language-bash">
cd gnat/tutorials/3D_kobayashi
</code></pre><section class="scrollspy" id="7b7682e8-0206-423a-9840-e331f05c1442" data-section-level="2" data-section-text="Common Material Properties"><h2 id="common-material-properties">Common Material Properties</h2><p>All of the Kobayashi problems use the same material properties. These consist of an isotropic neutron source, a near-void material (to generate streaming paths), and a shield. The specifications for the materials can be found in <a href="#kob_mats">Table 1</a>.</p><div class="card moose-float"><div class="card-content"><p class="moose-caption"><span class="moose-caption-heading">Table 1: </span><span class="moose-caption-text" id="kob_mats">Material properties for the Kobayashi benchmarks.</span></p><div form="['left', 'center', 'center', 'center']" recursive class="moose-table-div"><table><thead><tr><th style=";text-align:left">Material</th><th style=";text-align:center"><span class="moose-katex-inline-equation" id="moose-equation-d87efc64-6e5a-4586-b7bc-aa745df021b7"><script>var element = document.getElementById("moose-equation-d87efc64-6e5a-4586-b7bc-aa745df021b7");katex.render("\\Sigma_{t}", element, {displayMode:false,throwOnError:false});</script></span> (<span class="moose-katex-inline-equation" id="moose-equation-1cd035c4-5953-4b2a-ad35-5fcb88d0f525"><script>var element = document.getElementById("moose-equation-1cd035c4-5953-4b2a-ad35-5fcb88d0f525");katex.render("\\text{cm}^{-1}", element, {displayMode:false,throwOnError:false});</script></span>)</th><th style=";text-align:center"><span class="moose-katex-inline-equation" id="moose-equation-e3c11879-040e-4c09-9d2a-877976f735b3"><script>var element = document.getElementById("moose-equation-e3c11879-040e-4c09-9d2a-877976f735b3");katex.render("\\Sigma_{s}", element, {displayMode:false,throwOnError:false});</script></span> (<span class="moose-katex-inline-equation" id="moose-equation-b29ebec5-6c15-48f8-b660-5315d8e262f6"><script>var element = document.getElementById("moose-equation-b29ebec5-6c15-48f8-b660-5315d8e262f6");katex.render("\\text{cm}^{-1}", element, {displayMode:false,throwOnError:false});</script></span>)</th><th style=";text-align:center"><span class="moose-katex-inline-equation" id="moose-equation-201ea43a-7344-4dac-b5b9-8944c4564a3b"><script>var element = document.getElementById("moose-equation-201ea43a-7344-4dac-b5b9-8944c4564a3b");katex.render("q", element, {displayMode:false,throwOnError:false});</script></span> (<span class="moose-katex-inline-equation" id="moose-equation-f8c1ea68-b1fb-46fa-b054-5fac1d910126"><script>var element = document.getElementById("moose-equation-f8c1ea68-b1fb-46fa-b054-5fac1d910126");katex.render("\\text{cm}^{-3}s^{-1}", element, {displayMode:false,throwOnError:false});</script></span>)</th></tr></thead><tbody><tr><td style=";text-align:left">Source</td><td style=";text-align:center"><span class="moose-katex-inline-equation" id="moose-equation-2ae2694e-df61-470a-818c-214d82bff1de"><script>var element = document.getElementById("moose-equation-2ae2694e-df61-470a-818c-214d82bff1de");katex.render("1\\times10^{-1}", element, {displayMode:false,throwOnError:false});</script></span></td><td style=";text-align:center"><span class="moose-katex-inline-equation" id="moose-equation-d9160ce5-0e4e-47e8-a128-3a6f38639660"><script>var element = document.getElementById("moose-equation-d9160ce5-0e4e-47e8-a128-3a6f38639660");katex.render("5\\times10^{-2}", element, {displayMode:false,throwOnError:false});</script></span></td><td style=";text-align:center">1.0</td></tr></tbody><tbody><tr><td style=";text-align:left">Near-Void</td><td style=";text-align:center"><span class="moose-katex-inline-equation" id="moose-equation-e4560539-5cba-47b5-b3cb-f65037e28bea"><script>var element = document.getElementById("moose-equation-e4560539-5cba-47b5-b3cb-f65037e28bea");katex.render("1\\times10^{-4}", element, {displayMode:false,throwOnError:false});</script></span></td><td style=";text-align:center"><span class="moose-katex-inline-equation" id="moose-equation-e9c93bc9-8edd-47a8-b1d5-08865c602855"><script>var element = document.getElementById("moose-equation-e9c93bc9-8edd-47a8-b1d5-08865c602855");katex.render("5\\times10^{-5}", element, {displayMode:false,throwOnError:false});</script></span></td><td style=";text-align:center">0.0</td></tr></tbody><tbody><tr><td style=";text-align:left">Shield</td><td style=";text-align:center"><span class="moose-katex-inline-equation" id="moose-equation-0d16a680-fee3-4ef2-8132-c09d19dac44c"><script>var element = document.getElementById("moose-equation-0d16a680-fee3-4ef2-8132-c09d19dac44c");katex.render("1\\times10^{-1}", element, {displayMode:false,throwOnError:false});</script></span></td><td style=";text-align:center"><span class="moose-katex-inline-equation" id="moose-equation-165ad07e-0bc1-4326-a85b-b4a8210dc1ce"><script>var element = document.getElementById("moose-equation-165ad07e-0bc1-4326-a85b-b4a8210dc1ce");katex.render("5\\times10^{-2}", element, {displayMode:false,throwOnError:false});</script></span></td><td style=";text-align:center">0.0</td></tr></tbody></table></div></div></div></section><section class="scrollspy" id="32d24731-87de-4bd7-a4cc-2f4c787c3b54" data-section-level="2" data-section-text="Volume Source in a Cubic Shield"><h2 id="volume-source-in-a-cubic-shield">Volume Source in a Cubic Shield</h2><p>The first Kobayashi benchmark problem consists of a <span class="moose-katex-inline-equation" id="moose-equation-0db04a10-53d1-44cd-8cf8-7d4d2dd31b37"><script>var element = document.getElementById("moose-equation-0db04a10-53d1-44cd-8cf8-7d4d2dd31b37");katex.render("10\\text{ cm }\\times 10\\text{ cm }\\times 10\\text{ cm}", element, {displayMode:false,throwOnError:false});</script></span> cubic volume source with one corner centered on the origin. The source is surrounded on three sides by a <span class="moose-katex-inline-equation" id="moose-equation-46777adf-3cff-4a3e-a743-e724e51bc664"><script>var element = document.getElementById("moose-equation-46777adf-3cff-4a3e-a743-e724e51bc664");katex.render("40\\text{ cm}", element, {displayMode:false,throwOnError:false});</script></span> thick near-source reigon, which is further encased in a <span class="moose-katex-inline-equation" id="moose-equation-2c1be336-3ea8-4062-8ae8-0a041f340f2b"><script>var element = document.getElementById("moose-equation-2c1be336-3ea8-4062-8ae8-0a041f340f2b");katex.render("50\\text{ cm}", element, {displayMode:false,throwOnError:false});</script></span> thick shield. The boundary planes with <span class="moose-katex-inline-equation" id="moose-equation-e3f3233b-ef37-4805-84bd-6871e660ba08"><script>var element = document.getElementById("moose-equation-e3f3233b-ef37-4805-84bd-6871e660ba08");katex.render("x = 0", element, {displayMode:false,throwOnError:false});</script></span>, <span class="moose-katex-inline-equation" id="moose-equation-fdd45e97-baad-4d52-86b9-9cb2e1528cc2"><script>var element = document.getElementById("moose-equation-fdd45e97-baad-4d52-86b9-9cb2e1528cc2");katex.render("y = 0", element, {displayMode:false,throwOnError:false});</script></span>, and <span class="moose-katex-inline-equation" id="moose-equation-fb1f6539-a746-477e-8a22-ea99da616be6"><script>var element = document.getElementById("moose-equation-fb1f6539-a746-477e-8a22-ea99da616be6");katex.render("z = 0", element, {displayMode:false,throwOnError:false});</script></span> use reflective boundary conditions. The boundary planes with <span class="moose-katex-inline-equation" id="moose-equation-0450186d-8842-4bc8-b3cb-ab85c7cb8a3f"><script>var element = document.getElementById("moose-equation-0450186d-8842-4bc8-b3cb-ab85c7cb8a3f");katex.render("x = 100", element, {displayMode:false,throwOnError:false});</script></span>, <span class="moose-katex-inline-equation" id="moose-equation-93d935b5-fb62-47d8-a354-00f8bb8b8c49"><script>var element = document.getElementById("moose-equation-93d935b5-fb62-47d8-a354-00f8bb8b8c49");katex.render("y = 100", element, {displayMode:false,throwOnError:false});</script></span>, and <span class="moose-katex-inline-equation" id="moose-equation-ba83e1ae-dc39-4ca4-808d-a5ad87ae4439"><script>var element = document.getElementById("moose-equation-ba83e1ae-dc39-4ca4-808d-a5ad87ae4439");katex.render("z = 100", element, {displayMode:false,throwOnError:false});</script></span> are vaccum boundaries. The geometry of the problem can be found in <a href="#kob_1_geom">Figure 1</a>.</p><div class="card moose-float" style="width:50%;margin-left:auto;margin-right:auto;halign:center" id="kob_1_geom"><div class="card-content"><picture class="materialboxed moose-image"><img src="../media/3D_kobayashi/kob_1_geom.png"></img></picture><p class="moose-caption"><span class="moose-caption-heading">Figure 1: </span><span class="moose-caption-text" id="kob_1_geom">Geometry of the first Kobayashi problem. Green: source. White: near-void. Red: shield.</span></p></div></div><p>The Gnat input file to model this problem starts with the mesh, which is generated with a <a href="https://mooseframework.inl.gov/source/meshgenerators/CartesianMeshGenerator.html">CartesianMeshGenerator</a>. We specify that the generated mesh should be 3D (<code>dim = 3</code>) and that we have three distinct subdivisions with <code>dx</code>, <code>dy</code>, and <code>dz</code>. We then set the number of elements we want for each subdivision with <code>ix</code>, <code>iy</code>, and <code>iz</code>. In this model, we start with one element per <span class="moose-katex-inline-equation" id="moose-equation-341a25f2-e909-4bcf-9853-02e83bdc84f2"><script>var element = document.getElementById("moose-equation-341a25f2-e909-4bcf-9853-02e83bdc84f2");katex.render("10\\text{ cm}", element, {displayMode:false,throwOnError:false});</script></span> interval. We then add block ids for material and volume source assignment using <code>subdomain_id</code>. This vector must be the same length as the product of the lengths of <code>dx</code>, <code>dy</code>, and <code>dz</code>. The generated mesh is uniformely refined once with <code>uniform_refine = 1</code>. This mesh generator automatically adds side sets for the six faces of the cube named <code>left</code>, <code>right</code>, <code>top</code>, <code>bottom</code>, <code>front</code>, and <code>back</code> which we can use for boundary conditions.</p><pre class="moose-pre" style="max-height:350px;"><code class="language-moose">[Mesh]
  [domain]
    type = CartesianMeshGenerator&lt;&lt;&lt;{&quot;description&quot;: &quot;This CartesianMeshGenerator creates a non-uniform Cartesian mesh.&quot;}&gt;&gt;&gt;
    dim&lt;&lt;&lt;{&quot;description&quot;: &quot;The dimension of the mesh to be generated&quot;}&gt;&gt;&gt; = 3
    dx&lt;&lt;&lt;{&quot;description&quot;: &quot;Intervals in the X direction&quot;}&gt;&gt;&gt; = &#x27;10 40 50&#x27;
    dy&lt;&lt;&lt;{&quot;description&quot;: &quot;Intervals in the Y direction (required when dim&gt;1 otherwise ignored)&quot;}&gt;&gt;&gt; = &#x27;10 40 50&#x27;
    dz&lt;&lt;&lt;{&quot;description&quot;: &quot;Intervals in the Z direction (required when dim&gt;2 otherwise ignored)&quot;}&gt;&gt;&gt; = &#x27;10 40 50&#x27;
    ix&lt;&lt;&lt;{&quot;description&quot;: &quot;Number of grids in all intervals in the X direction (default to all one)&quot;}&gt;&gt;&gt; = &#x27;1 4 5&#x27;
    iy&lt;&lt;&lt;{&quot;description&quot;: &quot;Number of grids in all intervals in the Y direction (default to all one)&quot;}&gt;&gt;&gt; = &#x27;1 4 5&#x27;
    iz&lt;&lt;&lt;{&quot;description&quot;: &quot;Number of grids in all intervals in the Z direction (default to all one)&quot;}&gt;&gt;&gt; = &#x27;1 4 5&#x27;
    subdomain_id&lt;&lt;&lt;{&quot;description&quot;: &quot;Block IDs (default to all zero)&quot;}&gt;&gt;&gt; = &#x27;
    2 0 1
    0 0 1
    1 1 1

    0 0 1
    0 0 1
    1 1 1

    1 1 1
    1 1 1
    1 1 1&#x27;
  []
  uniform_refine&lt;&lt;&lt;{&quot;description&quot;: &quot;Specify the level of uniform refinement applied to the initial mesh&quot;}&gt;&gt;&gt; = 1
[]</code></pre><a class="moose-source-filename tooltipped modal-trigger" href="#51f8b7b5-27e3-408c-a6bb-11c7822e3806">(tutorials/3D_kobayashi/kobayashi_1.i)</a><p>After specifying the mesh, we move on to setting up the transport system. The Kobayashi problems are mono-energetic, so we specify that we only want a single energy group. Similarily, the scattering cross sections are isotropic and so we don&#x27;t need to evaluate higher order angular moments of the flux. We specify that we want to use the SAAF-CFEM-S<span class="moose-katex-inline-equation" id="moose-equation-d7ba5a21-114b-4cb4-8b1e-162c05252016"><script>var element = document.getElementById("moose-equation-d7ba5a21-114b-4cb4-8b1e-162c05252016");katex.render("_{\\text{N}}", element, {displayMode:false,throwOnError:false});</script></span> method with <code>scheme = saaf_cfem</code>, and that <code>particle_type = neutron</code> (which is arbitrary, <code>particle_type = photon</code> would also suffice). We specify that linear Lagrange basis functions should be used, and that a Gauss-Chebyshev angular quadrature set with five polar angles and five azimuthal angles per octant of the unit sphere should be used. Finally, we apply reflective boundary conditions along the lines of symmetry, apply vacuum boundary conditions to the remaining faces, and specify that the isotropic volume source with unit intensity should be applied to block 2.</p><pre class="moose-pre" style="max-height:350px;"><code class="language-moose">[TransportSystems&lt;&lt;&lt;{&quot;href&quot;: &quot;../syntax/TransportSystems/index.html&quot;}&gt;&gt;&gt;]
  [Neutron]
    num_groups&lt;&lt;&lt;{&quot;description&quot;: &quot;The number of spectral energy groups in the problem.&quot;}&gt;&gt;&gt; = 1
    max_anisotropy&lt;&lt;&lt;{&quot;description&quot;: &quot;The maximum degree of anisotropy to evaluate. Defaults to 0 for isotropic scattering.&quot;}&gt;&gt;&gt; = 0
    scheme&lt;&lt;&lt;{&quot;description&quot;: &quot;The discretization and stabilization scheme for the transport equation.&quot;}&gt;&gt;&gt; = saaf_cfem
    particle_type&lt;&lt;&lt;{&quot;description&quot;: &quot;The type of particle to be consuming material property data.&quot;}&gt;&gt;&gt; = neutron

    order&lt;&lt;&lt;{&quot;description&quot;: &quot;Specifies the order of the FE shape function to use for this variable (additional orders not listed are allowed).&quot;}&gt;&gt;&gt; = FIRST
    family&lt;&lt;&lt;{&quot;description&quot;: &quot;Specifies the family of FE shape functions to use for this variable.&quot;}&gt;&gt;&gt; = LAGRANGE

    n_azimuthal&lt;&lt;&lt;{&quot;description&quot;: &quot;Number of Chebyshev azimuthal quadrature points in a single octant of the unit sphere. Defaults to 3.&quot;}&gt;&gt;&gt; = 5
    n_polar&lt;&lt;&lt;{&quot;description&quot;: &quot;Number of Legendre polar quadrature points in a single octant of the unit sphere. Defaults to 3.&quot;}&gt;&gt;&gt; = 5

    vacuum_boundaries&lt;&lt;&lt;{&quot;description&quot;: &quot;The boundaries to apply vacuum boundary conditions.&quot;}&gt;&gt;&gt; = &#x27;right top front&#x27;
    reflective_boundaries&lt;&lt;&lt;{&quot;description&quot;: &quot;The boundaries to apply reflective boundary conditions.&quot;}&gt;&gt;&gt; = &#x27;back bottom left&#x27;

    volumetric_source_blocks&lt;&lt;&lt;{&quot;description&quot;: &quot;The list of blocks (ids or names) that host a volumetric source.&quot;}&gt;&gt;&gt; = &#x27;2&#x27;
    volumetric_source_moments&lt;&lt;&lt;{&quot;description&quot;: &quot;A double vector containing a list of external source moments for all volumetric particle sources. The external vector should correspond with the order of &#x27;volumetric_source_blocks&#x27;.&quot;}&gt;&gt;&gt; = &#x27;1.0&#x27;
    volumetric_source_anisotropies&lt;&lt;&lt;{&quot;description&quot;: &quot;The anisotropies of the volumetric sources. The vector should correspond with the order of &#x27;volumetric_source_blocks&#x27;&quot;}&gt;&gt;&gt; = &#x27;0&#x27;
  []
[]</code></pre><a class="moose-source-filename tooltipped modal-trigger" href="#e286de38-e0d1-4752-ad1f-9236ff38f746">(tutorials/3D_kobayashi/kobayashi_1.i)</a><p>Next, the material properties of the domain must be specified with <code>TransportMaterials</code>:</p><pre class="moose-pre" style="max-height:350px;"><code class="language-moose">[TransportMaterials&lt;&lt;&lt;{&quot;href&quot;: &quot;../syntax/TransportMaterials/index.html&quot;}&gt;&gt;&gt;]
  [Shield]
    type = ConstantTransportMaterial&lt;&lt;&lt;{&quot;description&quot;: &quot;Provides the particle group velocity ($v_{g}$), particle group total cross-section ($\\Sigma_{a,g}$), and the scattering cross-section moments ($\\Sigma_{s, g&#x27;, g, l}$) for transport problems. If no scattering cross-section moments are provided, the material initializes all moments to 0. The properties must be listed in decreasing order by energy.&quot;, &quot;href&quot;: &quot;../source/materials/ConstantTransportMaterial.html&quot;}&gt;&gt;&gt;
    transport_system&lt;&lt;&lt;{&quot;description&quot;: &quot;Name of the transport system which will consume the provided material properties. If one is not provided the first transport system will be used.&quot;}&gt;&gt;&gt; = &#x27;Neutron&#x27;
    group_total&lt;&lt;&lt;{&quot;description&quot;: &quot;The macroscopic particle total cross-sections for all energy groups.&quot;}&gt;&gt;&gt; = &#x27;0.1&#x27;
    group_scattering&lt;&lt;&lt;{&quot;description&quot;: &quot;The group-to-group scattering cross-section moments for all energy groups.&quot;}&gt;&gt;&gt; = &#x27;0.05&#x27;
    anisotropy&lt;&lt;&lt;{&quot;description&quot;: &quot;The scattering anisotropy of the medium.&quot;}&gt;&gt;&gt; = 0
    block&lt;&lt;&lt;{&quot;description&quot;: &quot;The list of blocks (ids or names) that this object will be applied&quot;}&gt;&gt;&gt; = &#x27;1 2&#x27;
  []
  [Duct]
    type = ConstantTransportMaterial&lt;&lt;&lt;{&quot;description&quot;: &quot;Provides the particle group velocity ($v_{g}$), particle group total cross-section ($\\Sigma_{a,g}$), and the scattering cross-section moments ($\\Sigma_{s, g&#x27;, g, l}$) for transport problems. If no scattering cross-section moments are provided, the material initializes all moments to 0. The properties must be listed in decreasing order by energy.&quot;, &quot;href&quot;: &quot;../source/materials/ConstantTransportMaterial.html&quot;}&gt;&gt;&gt;
    transport_system&lt;&lt;&lt;{&quot;description&quot;: &quot;Name of the transport system which will consume the provided material properties. If one is not provided the first transport system will be used.&quot;}&gt;&gt;&gt; = &#x27;Neutron&#x27;
    group_total&lt;&lt;&lt;{&quot;description&quot;: &quot;The macroscopic particle total cross-sections for all energy groups.&quot;}&gt;&gt;&gt; = &#x27;1e-4&#x27;
    group_scattering&lt;&lt;&lt;{&quot;description&quot;: &quot;The group-to-group scattering cross-section moments for all energy groups.&quot;}&gt;&gt;&gt; = &#x27;0.5e-4&#x27;
    anisotropy&lt;&lt;&lt;{&quot;description&quot;: &quot;The scattering anisotropy of the medium.&quot;}&gt;&gt;&gt; = 0
    block&lt;&lt;&lt;{&quot;description&quot;: &quot;The list of blocks (ids or names) that this object will be applied&quot;}&gt;&gt;&gt; = &#x27;0&#x27;
  []
[]</code></pre><a class="moose-source-filename tooltipped modal-trigger" href="#f5c9eeb2-d704-4c69-a43c-384df31434d1">(tutorials/3D_kobayashi/kobayashi_1.i)</a><p>This declares three a constant materials which provides enough parameters for a single neutron group. <code>Shield</code> implements the shield material and souce material from <a href="#kob_mats">Table 1</a>, while <code>Duct</code> implements the near-void material. We note that the main differences between <code>Shield</code> and <code>Duct</code> are the values of <code>group_total</code>, <code>group_scattering</code>, and <code>block</code>. Both materials set <code>transport_system = &#x27;Neutron&#x27;</code> to link to the single transport system we set up, and specify <code>anisotropy = 0</code> (as these provided scattering cross sections are isotropic).</p><p>The remainder of the input file describes how the problem should be solved, the post-processors that should be added, and the outputs requested.</p><pre class="moose-pre" style="max-height:350px;"><code class="language-moose">[Executioner]
  type = Steady
  solve_type = PJFNK
  petsc_options_iname = &#x27;-pc_type -pc_hypre_type -ksp_gmres_restart&#x27;
  petsc_options_value = &#x27; hypre    boomeramg      100&#x27;
  l_max_its = 50
  nl_rel_tol = 1e-12

  automatic_scaling = true
  off_diagonals_in_auto_scaling = true
  compute_scaling_once = false
[]</code></pre><a class="moose-source-filename tooltipped modal-trigger" href="#4c16ecbd-16ca-4aac-a8fb-cf1ebfc1a951">(tutorials/3D_kobayashi/kobayashi_1.i)</a><p>The <code>Executioner</code> block declares the solver parameters and solve type. In this case, <code>type = Steady</code> and the Preconditioned Jacobian-Free Newton Krylov (<code>solve_type = PJFNK</code>) is used. It is recommended that the user employ the PJFNK solver for continuous finite element methods when solving radiation transport problems with the SAAF-CFEM-S<span class="moose-katex-inline-equation" id="moose-equation-9fff4e2e-20fa-4cac-af19-feaf85d2f035"><script>var element = document.getElementById("moose-equation-9fff4e2e-20fa-4cac-af19-feaf85d2f035");katex.render("_{\\text{N}}", element, {displayMode:false,throwOnError:false});</script></span> scheme. Next, we add a collection of <code>VectorPostprocessors</code> to plot the solution along the lines required to match the results reported by <a href="#kobayashi">Kobayashi et al. (2001)</a>. These include: a line from the center of the source along the y direction (<code>Line_A</code>); a line along the diagonal from the center of the source to the corner of the domain (<code>Line_B</code>); and a line along the discontinuity between the shield and the near-void region (<code>Line_C</code>).</p><pre class="moose-pre" style="max-height:350px;"><code class="language-moose">[VectorPostprocessors]
  [Line_A]
    type = LineValueSampler&lt;&lt;&lt;{&quot;description&quot;: &quot;Samples variable(s) along a specified line&quot;}&gt;&gt;&gt;
    variable&lt;&lt;&lt;{&quot;description&quot;: &quot;The names of the variables that this VectorPostprocessor operates on&quot;}&gt;&gt;&gt; = flux_moment_1_0_0
    start_point&lt;&lt;&lt;{&quot;description&quot;: &quot;The beginning of the line&quot;}&gt;&gt;&gt; = &#x27;5.0 5.0  5.0&#x27;
    end_point&lt;&lt;&lt;{&quot;description&quot;: &quot;The ending of the line&quot;}&gt;&gt;&gt; = &#x27;5.0 95.0 5.0&#x27;
    num_points&lt;&lt;&lt;{&quot;description&quot;: &quot;The number of points to sample along the line&quot;}&gt;&gt;&gt; = 10
    sort_by&lt;&lt;&lt;{&quot;description&quot;: &quot;What to sort the samples by&quot;}&gt;&gt;&gt; = y
  []

  [Line_B]
    type = LineValueSampler&lt;&lt;&lt;{&quot;description&quot;: &quot;Samples variable(s) along a specified line&quot;}&gt;&gt;&gt;
    variable&lt;&lt;&lt;{&quot;description&quot;: &quot;The names of the variables that this VectorPostprocessor operates on&quot;}&gt;&gt;&gt; = flux_moment_1_0_0
    start_point&lt;&lt;&lt;{&quot;description&quot;: &quot;The beginning of the line&quot;}&gt;&gt;&gt; = &#x27;5.0 5.0  5.0&#x27;
    end_point&lt;&lt;&lt;{&quot;description&quot;: &quot;The ending of the line&quot;}&gt;&gt;&gt; = &#x27;95.0 95.0 95.0&#x27;
    num_points&lt;&lt;&lt;{&quot;description&quot;: &quot;The number of points to sample along the line&quot;}&gt;&gt;&gt; = 10
    sort_by&lt;&lt;&lt;{&quot;description&quot;: &quot;What to sort the samples by&quot;}&gt;&gt;&gt; = x
  []

  [Line_C]
    type = LineValueSampler&lt;&lt;&lt;{&quot;description&quot;: &quot;Samples variable(s) along a specified line&quot;}&gt;&gt;&gt;
    variable&lt;&lt;&lt;{&quot;description&quot;: &quot;The names of the variables that this VectorPostprocessor operates on&quot;}&gt;&gt;&gt; = flux_moment_1_0_0
    start_point&lt;&lt;&lt;{&quot;description&quot;: &quot;The beginning of the line&quot;}&gt;&gt;&gt; = &#x27;5.0  55.0 5.0&#x27;
    end_point&lt;&lt;&lt;{&quot;description&quot;: &quot;The ending of the line&quot;}&gt;&gt;&gt; = &#x27;95.0 55.0 5.0&#x27;
    num_points&lt;&lt;&lt;{&quot;description&quot;: &quot;The number of points to sample along the line&quot;}&gt;&gt;&gt; = 10
    sort_by&lt;&lt;&lt;{&quot;description&quot;: &quot;What to sort the samples by&quot;}&gt;&gt;&gt; = x
  []
[]</code></pre><a class="moose-source-filename tooltipped modal-trigger" href="#188ca5ad-ab67-4604-8195-6e80947fcf6b">(tutorials/3D_kobayashi/kobayashi_1.i)</a><p>As we are adding post-processors, we need to specify that we want CSV output in addition to Exodus output.</p><pre class="moose-pre" style="max-height:350px;"><code class="language-moose">[Outputs]
  exodus&lt;&lt;&lt;{&quot;description&quot;: &quot;Output the results using the default settings for Exodus output.&quot;}&gt;&gt;&gt; = true
  csv&lt;&lt;&lt;{&quot;description&quot;: &quot;Output the scalar variable and postprocessors to a *.csv file using the default CSV output.&quot;}&gt;&gt;&gt; = true
  execute_on&lt;&lt;&lt;{&quot;description&quot;: &quot;The list of flag(s) indicating when this object should be executed. For a description of each flag, see https://mooseframework.inl.gov/source/interfaces/SetupInterface.html.&quot;}&gt;&gt;&gt; = &#x27;TIMESTEP_END&#x27;
[]</code></pre><a class="moose-source-filename tooltipped modal-trigger" href="#f0ab6b33-a4f7-483d-8d28-43f5e94c8b5c">(tutorials/3D_kobayashi/kobayashi_1.i)</a><p>The simulation can be executed with the following shell command:</p><pre class="moose-pre"><code class="language-bash">
mpiexec -np 4 gnat-opt -i ./kobayashi_1.i --n-threads=2
</code></pre><p>which will run the problem with four MPI ranks and two OpenMP threads per rank. The scalar flux calculated by Gnat can be found in <a href="#kob_1_flux">Figure 2</a>.</p><div class="card moose-float" style="width:50%;margin-left:auto;margin-right:auto;halign:center" id="kob_1_flux"><div class="card-content"><picture class="materialboxed moose-image"><img src="../media/3D_kobayashi/kob_1_flux.png"></img></picture><p class="moose-caption"><span class="moose-caption-heading">Figure 2: </span><span class="moose-caption-text" id="kob_1_flux">Scalar flux for the first Kobayashi benchmark.</span></p></div></div><p>Plotting the post-processed results from the three <a href="https://mooseframework.inl.gov/source/vectorpostprocessors/LineValueSampler.html">LineValueSampler</a>s results in <a href="#kob_1a">Figure 5</a>, <a href="#kob_1b">Figure 6</a>, and <a href="#kob_1c">Figure 7</a>.</p><div class="row" style="display:inline-flex;"><div class="col s12 m12 l12"><div class="card moose-float" style="width:100%;margin-left:auto;margin-right:auto;halign:center" id="kob_1a"><div class="card-content"><picture class="materialboxed moose-image"><img src="../media/3D_kobayashi/kob_1_A_err.png"></img></picture><p class="moose-caption"><span class="moose-caption-heading">Figure 5: </span><span class="moose-caption-text" id="kob_1a">Scalar flux plotted along line A for the first Kobayashi benchmark.</span></p></div></div><p></p></div><div class="col s12 m12 l12"><div class="card moose-float" style="width:100%;margin-left:auto;margin-right:auto;halign:center" id="kob_1b"><div class="card-content"><picture class="materialboxed moose-image"><img src="../media/3D_kobayashi/kob_1_B_err.png"></img></picture><p class="moose-caption"><span class="moose-caption-heading">Figure 6: </span><span class="moose-caption-text" id="kob_1b">Scalar flux plotted along line B for the first Kobayashi benchmark.</span></p></div></div><p></p></div><div class="col s12 m12 l12"><div class="card moose-float" style="width:100%;margin-left:auto;margin-right:auto;halign:center" id="kob_1c"><div class="card-content"><picture class="materialboxed moose-image"><img src="../media/3D_kobayashi/kob_1_C_err.png"></img></picture><p class="moose-caption"><span class="moose-caption-heading">Figure 7: </span><span class="moose-caption-text" id="kob_1c">Scalar flux plotted along line C for the first Kobayashi benchmark.</span></p></div></div><p></p></div><p></p></div><p>We can clearly see the impact of ray effects from the limited number of samples in the angular quadrature set, alongside the imapct of the coarse spatial discretization which manifest in oscillations in the scalar flux. These will be come more pronounced in the following sections, where the straight duct and dog-legged duct problems are modelled.</p></section><section class="scrollspy" id="31f932fa-a383-437e-91e4-f8152f55f975" data-section-level="2" data-section-text="Straight Duct"><h2 id="straight-duct">Straight Duct</h2><p>The second Kobayashi benchmark problem consists of a <span class="moose-katex-inline-equation" id="moose-equation-da37db77-1d40-44c1-9df8-269aba92c144"><script>var element = document.getElementById("moose-equation-da37db77-1d40-44c1-9df8-269aba92c144");katex.render("10\\text{ cm }\\times 10\\text{ cm }\\times 10\\text{ cm}", element, {displayMode:false,throwOnError:false});</script></span> cubic volume source with one corner centered on the origin. It is surrounded by a shield that is <span class="moose-katex-inline-equation" id="moose-equation-1d86caa8-46be-43c0-9aee-aa25cb15f81d"><script>var element = document.getElementById("moose-equation-1d86caa8-46be-43c0-9aee-aa25cb15f81d");katex.render("90\\text{ cm}", element, {displayMode:false,throwOnError:false});</script></span> thick along the positive y direction and <span class="moose-katex-inline-equation" id="moose-equation-956cd507-6728-4021-8f27-b3259b70cae6"><script>var element = document.getElementById("moose-equation-956cd507-6728-4021-8f27-b3259b70cae6");katex.render("50\\text{ cm}", element, {displayMode:false,throwOnError:false});</script></span> thick along the x and z direction. The <span class="moose-katex-inline-equation" id="moose-equation-2743d67d-656b-4913-b2a3-5139e0847836"><script>var element = document.getElementById("moose-equation-2743d67d-656b-4913-b2a3-5139e0847836");katex.render("90\\text{ cm}", element, {displayMode:false,throwOnError:false});</script></span> long component of the shield is penetrated by a duct with a square cross section, yielding a long streaming path. The geometry of this problem can be found in <a href="#kob_2_geom">Figure 3</a>. Similar to the first benchmark problem, three sides use reflective boundary conditions while the remaining three sides use vacuum boundaries.</p><div class="card moose-float" style="width:50%;margin-left:auto;margin-right:auto;halign:center" id="kob_2_geom"><div class="card-content"><picture class="materialboxed moose-image"><img src="../media/3D_kobayashi/kob_2_geom.png"></img></picture><p class="moose-caption"><span class="moose-caption-heading">Figure 3: </span><span class="moose-caption-text" id="kob_2_geom">Geometry of the second Kobayashi problem. Green: source. White: near-void. Red: shield.</span></p></div></div><p>There are two differences between the previously modelled cubic shield problem and the straight duct problem. The first is the definition of the mesh where <code>dx</code>, <code>dy</code>, and <code>dz</code> are modified to change the configuration of the geometry. <code>ix</code>, <code>iy</code>, and <code>iz</code> are then changed to maintain <span class="moose-katex-inline-equation" id="moose-equation-d0a91ea6-c849-4a0f-85a5-d23f22da9ba5"><script>var element = document.getElementById("moose-equation-d0a91ea6-c849-4a0f-85a5-d23f22da9ba5");katex.render("10\\text{ cm}", element, {displayMode:false,throwOnError:false});</script></span> element intervals. Finally, the blocks are remapped to capture the material changes. The changes to the mesh can be found below.</p><pre class="moose-pre" style="max-height:350px;"><code class="language-moose">[Mesh]
  [domain]
    type = CartesianMeshGenerator&lt;&lt;&lt;{&quot;description&quot;: &quot;This CartesianMeshGenerator creates a non-uniform Cartesian mesh.&quot;}&gt;&gt;&gt;
    dim&lt;&lt;&lt;{&quot;description&quot;: &quot;The dimension of the mesh to be generated&quot;}&gt;&gt;&gt; = 3
    dx&lt;&lt;&lt;{&quot;description&quot;: &quot;Intervals in the X direction&quot;}&gt;&gt;&gt; = &#x27;10 50&#x27;
    dy&lt;&lt;&lt;{&quot;description&quot;: &quot;Intervals in the Y direction (required when dim&gt;1 otherwise ignored)&quot;}&gt;&gt;&gt; = &#x27;10 90&#x27;
    dz&lt;&lt;&lt;{&quot;description&quot;: &quot;Intervals in the Z direction (required when dim&gt;2 otherwise ignored)&quot;}&gt;&gt;&gt; = &#x27;10 50&#x27;
    ix&lt;&lt;&lt;{&quot;description&quot;: &quot;Number of grids in all intervals in the X direction (default to all one)&quot;}&gt;&gt;&gt; = &#x27;1 5&#x27;
    iy&lt;&lt;&lt;{&quot;description&quot;: &quot;Number of grids in all intervals in the Y direction (default to all one)&quot;}&gt;&gt;&gt; = &#x27;1 9&#x27;
    iz&lt;&lt;&lt;{&quot;description&quot;: &quot;Number of grids in all intervals in the Z direction (default to all one)&quot;}&gt;&gt;&gt; = &#x27;1 5&#x27;
    subdomain_id&lt;&lt;&lt;{&quot;description&quot;: &quot;Block IDs (default to all zero)&quot;}&gt;&gt;&gt; = &#x27;
    2 1
    0 1

    1 1
    1 1&#x27;
  []
  uniform_refine&lt;&lt;&lt;{&quot;description&quot;: &quot;Specify the level of uniform refinement applied to the initial mesh&quot;}&gt;&gt;&gt; = 1
[]</code></pre><a class="moose-source-filename tooltipped modal-trigger" href="#ef4de371-c4f8-4a3b-a11b-01b7c2f1e3e8">(tutorials/3D_kobayashi/kobayashi_2.i)</a><p>The second change to the input file is the <a href="https://mooseframework.inl.gov/source/vectorpostprocessors/LineValueSampler.html">LineValueSampler</a>s we use to post-process the solution. <code>Line_A</code> is modified such that it plots down the length of the duct and <code>Line_B</code> is modified such that it plots from the centerline of the duct into the shield at the edge of the domain. The new <code>VectorPostprocessor</code>s can be found below.</p><pre class="moose-pre" style="max-height:350px;"><code class="language-moose">[VectorPostprocessors]
  [Line_A]
    type = LineValueSampler&lt;&lt;&lt;{&quot;description&quot;: &quot;Samples variable(s) along a specified line&quot;}&gt;&gt;&gt;
    variable&lt;&lt;&lt;{&quot;description&quot;: &quot;The names of the variables that this VectorPostprocessor operates on&quot;}&gt;&gt;&gt; = flux_moment_1_0_0
    start_point&lt;&lt;&lt;{&quot;description&quot;: &quot;The beginning of the line&quot;}&gt;&gt;&gt; = &#x27;5.0 5.0  5.0&#x27;
    end_point&lt;&lt;&lt;{&quot;description&quot;: &quot;The ending of the line&quot;}&gt;&gt;&gt; = &#x27;5.0 95.0 5.0&#x27;
    num_points&lt;&lt;&lt;{&quot;description&quot;: &quot;The number of points to sample along the line&quot;}&gt;&gt;&gt; = 10
    sort_by&lt;&lt;&lt;{&quot;description&quot;: &quot;What to sort the samples by&quot;}&gt;&gt;&gt; = y
  []

  [Line_B]
    type = LineValueSampler&lt;&lt;&lt;{&quot;description&quot;: &quot;Samples variable(s) along a specified line&quot;}&gt;&gt;&gt;
    variable&lt;&lt;&lt;{&quot;description&quot;: &quot;The names of the variables that this VectorPostprocessor operates on&quot;}&gt;&gt;&gt; = flux_moment_1_0_0
    start_point&lt;&lt;&lt;{&quot;description&quot;: &quot;The beginning of the line&quot;}&gt;&gt;&gt; = &#x27;5.0  95.0 5.0&#x27;
    end_point&lt;&lt;&lt;{&quot;description&quot;: &quot;The ending of the line&quot;}&gt;&gt;&gt; = &#x27;55.0 95.0 5.0&#x27;
    num_points&lt;&lt;&lt;{&quot;description&quot;: &quot;The number of points to sample along the line&quot;}&gt;&gt;&gt; = 6
    sort_by&lt;&lt;&lt;{&quot;description&quot;: &quot;What to sort the samples by&quot;}&gt;&gt;&gt; = x
  []
[]</code></pre><a class="moose-source-filename tooltipped modal-trigger" href="#fe6249d2-8f25-4fab-bdd8-40993049acd3">(tutorials/3D_kobayashi/kobayashi_2.i)</a><p>The second Kobayashi problem can be run with the following:</p><pre class="moose-pre"><code class="language-bash">
mpiexec -np 4 gnat-opt -i ./kobayashi_2.i --n-threads=2
</code></pre><p>The scalar flux calculated by Gnat can be found in <a href="#kob_2_flux">Figure 4</a>.</p><div class="card moose-float" style="width:50%;margin-left:auto;margin-right:auto;halign:center" id="kob_2_flux"><div class="card-content"><picture class="materialboxed moose-image"><img src="../media/3D_kobayashi/kob_2_flux.png"></img></picture><p class="moose-caption"><span class="moose-caption-heading">Figure 4: </span><span class="moose-caption-text" id="kob_2_flux">Scalar flux for the second Kobayashi benchmark.</span></p></div></div><p>We can really see the ray effects in the solution which are caused by the low order quadrature set. Increasing the number of azimuthal angles per octant (<code>n_azimuthal</code>) would aid in mitigating these ray effects by adding more quadrature directions along the duct, though it would result in a large runtime penalty. The error between the Gnat results and the benchmark along <code>Line_A</code> and <code>Line_B</code> are plotted in <a href="#kob_2a">Figure 8</a> and <a href="#kob_2b">Figure 9</a>. Oscillations caused by the coarse mesh can be seen in <a href="#kob_2a">Figure 8</a>, and large undershoots in the solution compared to the reference (due to ray effects) can be seen in <a href="#kob_2b">Figure 9</a>.</p><div class="row" style="display:inline-flex;"><div class="col s12 m12 l12"><div class="card moose-float" style="width:100%;margin-left:auto;margin-right:auto;halign:center" id="kob_2a"><div class="card-content"><picture class="materialboxed moose-image"><img src="../media/3D_kobayashi/kob_2_A_err.png"></img></picture><p class="moose-caption"><span class="moose-caption-heading">Figure 8: </span><span class="moose-caption-text" id="kob_2a">Scalar flux plotted along line A for the second Kobayashi benchmark.</span></p></div></div><p></p></div><div class="col s12 m12 l12"><div class="card moose-float" style="width:100%;margin-left:auto;margin-right:auto;halign:center" id="kob_2b"><div class="card-content"><picture class="materialboxed moose-image"><img src="../media/3D_kobayashi/kob_2_B_err.png"></img></picture><p class="moose-caption"><span class="moose-caption-heading">Figure 9: </span><span class="moose-caption-text" id="kob_2b">Scalar flux plotted along line B for the second Kobayashi benchmark.</span></p></div></div><p></p></div><p></p></div></section><section class="scrollspy" id="22363293-c9ae-46db-adda-6cc6b8d2e51d" data-section-level="2" data-section-text="Dog - Legged Duct"><h2 id="dog-legged-duct">Dog-Legged Duct</h2><p>The last Kobayashi problem is similar to the second problem, where the only differece is that the duct makes three <span class="moose-katex-inline-equation" id="moose-equation-2e22093b-a7eb-41fa-8c9e-86ba0c3f90d8"><script>var element = document.getElementById("moose-equation-2e22093b-a7eb-41fa-8c9e-86ba0c3f90d8");katex.render("90^{\\circ}", element, {displayMode:false,throwOnError:false});</script></span> turns before exiting the shielding medium. The geometry of this problem can be found in <a href="#kob_3_geom_1">Figure 10</a> and <a href="#kob_3_geom_2">Figure 11</a>.</p><div class="row" style="display:inline-flex;"><div class="col s12 m12 l12"><div class="card moose-float" style="width:100%;margin-left:auto;margin-right:auto;halign:center" id="kob_3_geom_1"><div class="card-content"><picture class="materialboxed moose-image"><img src="../media/3D_kobayashi/kob_3_geom_1.png"></img></picture><p class="moose-caption"><span class="moose-caption-heading">Figure 10: </span><span class="moose-caption-text" id="kob_3_geom_1">Full geometry of the third Kobayashi problem. Green: source. White: near-void. Red: shield.</span></p></div></div><p></p></div><div class="col s12 m12 l12"><div class="card moose-float" style="width:100%;margin-left:auto;margin-right:auto;halign:center" id="kob_3_geom_2"><div class="card-content"><picture class="materialboxed moose-image"><img src="../media/3D_kobayashi/kob_3_geom_2.png"></img></picture><p class="moose-caption"><span class="moose-caption-heading">Figure 11: </span><span class="moose-caption-text" id="kob_3_geom_2">Dog-legged duct in the third Kobayashi problem.</span></p></div></div><p></p></div><p></p></div><p>Similar to the straight duct, the only changes we need to make to the input file are to the mesh and the post-processors we add to compare the solution to the reference solution. The <code>[Mesh]</code> block for this problem is substantially more complicated then the first and second problem due to the added heterogeneity; extra slices in <code>dx</code>, <code>dy</code>, and <code>dz</code> are required to model these material changes alongside additional block mappings in <code>subdomain_id</code>. The full mesh block can be found below.</p><pre class="moose-pre" style="max-height:350px;"><code class="language-moose">[Mesh]
  [domain]
    type = CartesianMeshGenerator&lt;&lt;&lt;{&quot;description&quot;: &quot;This CartesianMeshGenerator creates a non-uniform Cartesian mesh.&quot;}&gt;&gt;&gt;
    dim&lt;&lt;&lt;{&quot;description&quot;: &quot;The dimension of the mesh to be generated&quot;}&gt;&gt;&gt; = 3
    dx&lt;&lt;&lt;{&quot;description&quot;: &quot;Intervals in the X direction&quot;}&gt;&gt;&gt; = &#x27;10 20 10 20&#x27;
    dy&lt;&lt;&lt;{&quot;description&quot;: &quot;Intervals in the Y direction (required when dim&gt;1 otherwise ignored)&quot;}&gt;&gt;&gt; = &#x27;10 40 10 40&#x27;
    dz&lt;&lt;&lt;{&quot;description&quot;: &quot;Intervals in the Z direction (required when dim&gt;2 otherwise ignored)&quot;}&gt;&gt;&gt; = &#x27;10 20 10 20&#x27;
    ix&lt;&lt;&lt;{&quot;description&quot;: &quot;Number of grids in all intervals in the X direction (default to all one)&quot;}&gt;&gt;&gt; = &#x27;1 2 1 2&#x27;
    iy&lt;&lt;&lt;{&quot;description&quot;: &quot;Number of grids in all intervals in the Y direction (default to all one)&quot;}&gt;&gt;&gt; = &#x27;1 4 1 4&#x27;
    iz&lt;&lt;&lt;{&quot;description&quot;: &quot;Number of grids in all intervals in the Z direction (default to all one)&quot;}&gt;&gt;&gt; = &#x27;1 2 1 2&#x27;
    subdomain_id&lt;&lt;&lt;{&quot;description&quot;: &quot;Block IDs (default to all zero)&quot;}&gt;&gt;&gt; = &#x27;
    2 1 1 1
    0 1 1 1
    0 0 0 1
    1 1 1 1

    1 1 1 1
    1 1 1 1
    1 1 0 1
    1 1 1 1

    1 1 1 1
    1 1 1 1
    1 1 0 1
    1 1 0 1

    1 1 1 1
    1 1 1 1
    1 1 1 1
    1 1 1 1&#x27;
  []
  uniform_refine&lt;&lt;&lt;{&quot;description&quot;: &quot;Specify the level of uniform refinement applied to the initial mesh&quot;}&gt;&gt;&gt; = 1
[]</code></pre><a class="moose-source-filename tooltipped modal-trigger" href="#4db72a73-11a2-4218-9152-ffa5a575ccb6">(tutorials/3D_kobayashi/kobayashi_3.i)</a><p>When it comes to the changes in post-processors, <code>Line_A</code> plots along the center of the duct (before the first bend). <code>Line_B</code> plots along the interface between the duct and the shield at the first bend. <code>Line_C</code> plots across the duct after the third bend. The modifiications to the <code>LineValueSampler</code> post-processors can be found below.</p><pre class="moose-pre" style="max-height:350px;"><code class="language-moose">[VectorPostprocessors]
  [Line_A]
    type = LineValueSampler&lt;&lt;&lt;{&quot;description&quot;: &quot;Samples variable(s) along a specified line&quot;}&gt;&gt;&gt;
    variable&lt;&lt;&lt;{&quot;description&quot;: &quot;The names of the variables that this VectorPostprocessor operates on&quot;}&gt;&gt;&gt; = flux_moment_1_0_0
    start_point&lt;&lt;&lt;{&quot;description&quot;: &quot;The beginning of the line&quot;}&gt;&gt;&gt; = &#x27;5.0 5.0  5.0&#x27;
    end_point&lt;&lt;&lt;{&quot;description&quot;: &quot;The ending of the line&quot;}&gt;&gt;&gt; = &#x27;5.0 95.0 5.0&#x27;
    num_points&lt;&lt;&lt;{&quot;description&quot;: &quot;The number of points to sample along the line&quot;}&gt;&gt;&gt; = 10
    sort_by&lt;&lt;&lt;{&quot;description&quot;: &quot;What to sort the samples by&quot;}&gt;&gt;&gt; = y
  []

  [Line_B]
    type = LineValueSampler&lt;&lt;&lt;{&quot;description&quot;: &quot;Samples variable(s) along a specified line&quot;}&gt;&gt;&gt;
    variable&lt;&lt;&lt;{&quot;description&quot;: &quot;The names of the variables that this VectorPostprocessor operates on&quot;}&gt;&gt;&gt; = flux_moment_1_0_0
    start_point&lt;&lt;&lt;{&quot;description&quot;: &quot;The beginning of the line&quot;}&gt;&gt;&gt; = &#x27;5.0  55.0 5.0&#x27;
    end_point&lt;&lt;&lt;{&quot;description&quot;: &quot;The ending of the line&quot;}&gt;&gt;&gt; = &#x27;55.0 55.0 5.0&#x27;
    num_points&lt;&lt;&lt;{&quot;description&quot;: &quot;The number of points to sample along the line&quot;}&gt;&gt;&gt; = 6
    sort_by&lt;&lt;&lt;{&quot;description&quot;: &quot;What to sort the samples by&quot;}&gt;&gt;&gt; = x
  []

  [Line_C]
    type = LineValueSampler&lt;&lt;&lt;{&quot;description&quot;: &quot;Samples variable(s) along a specified line&quot;}&gt;&gt;&gt;
    variable&lt;&lt;&lt;{&quot;description&quot;: &quot;The names of the variables that this VectorPostprocessor operates on&quot;}&gt;&gt;&gt; = flux_moment_1_0_0
    start_point&lt;&lt;&lt;{&quot;description&quot;: &quot;The beginning of the line&quot;}&gt;&gt;&gt; = &#x27;5.0  95.0 35.0&#x27;
    end_point&lt;&lt;&lt;{&quot;description&quot;: &quot;The ending of the line&quot;}&gt;&gt;&gt; = &#x27;55.0 95.0 35.0&#x27;
    num_points&lt;&lt;&lt;{&quot;description&quot;: &quot;The number of points to sample along the line&quot;}&gt;&gt;&gt; = 6
    sort_by&lt;&lt;&lt;{&quot;description&quot;: &quot;What to sort the samples by&quot;}&gt;&gt;&gt; = x
  []
[]</code></pre><a class="moose-source-filename tooltipped modal-trigger" href="#6f0f6a28-6ca9-4a40-a5ad-61ab2f2d025b">(tutorials/3D_kobayashi/kobayashi_3.i)</a><p>The final Kobayashi problem can be run with the following:</p><pre class="moose-pre"><code class="language-bash">
mpiexec -np 4 gnat-opt -i ./kobayashi_3.i --n-threads=2
</code></pre><p>The scalar flux over the whole problem can be found in <a href="#kob_3_flux_1">Figure 12</a>, and the scalar flux along the duct can be found in <a href="#kob_3_flux_2">Figure 13</a>.</p><div class="row" style="display:inline-flex;"><div class="col s12 m12 l12"><div class="card moose-float" style="width:100%;margin-left:auto;margin-right:auto;halign:center" id="kob_3_flux_1"><div class="card-content"><picture class="materialboxed moose-image"><img src="../media/3D_kobayashi/kob_3_flux_1.png"></img></picture><p class="moose-caption"><span class="moose-caption-heading">Figure 12: </span><span class="moose-caption-text" id="kob_3_flux_1">Scalar flux in the third Kobayashi benchmark.</span></p></div></div><p></p></div><div class="col s12 m12 l12"><div class="card moose-float" style="width:100%;margin-left:auto;margin-right:auto;halign:center" id="kob_3_flux_2"><div class="card-content"><picture class="materialboxed moose-image"><img src="../media/3D_kobayashi/kob_3_flux_2.png"></img></picture><p class="moose-caption"><span class="moose-caption-heading">Figure 13: </span><span class="moose-caption-text" id="kob_3_flux_2">Scalar flux isolated to the dog-legged duct.</span></p></div></div><p></p></div><p></p></div><p>The results along each line compared to the reference scalar flux can be found below.</p><div class="row" style="display:inline-flex;"><div class="col s12 m12 l12"><div class="card moose-float" style="width:100%;margin-left:auto;margin-right:auto;halign:center" id="kob_3a"><div class="card-content"><picture class="materialboxed moose-image"><img src="../media/3D_kobayashi/kob_3_A_err.png"></img></picture><p class="moose-caption"><span class="moose-caption-heading">Figure 14: </span><span class="moose-caption-text" id="kob_3a">Scalar flux plotted along line A for the first Kobayashi benchmark.</span></p></div></div><p></p></div><div class="col s12 m12 l12"><div class="card moose-float" style="width:100%;margin-left:auto;margin-right:auto;halign:center" id="kob_3b"><div class="card-content"><picture class="materialboxed moose-image"><img src="../media/3D_kobayashi/kob_3_B_err.png"></img></picture><p class="moose-caption"><span class="moose-caption-heading">Figure 15: </span><span class="moose-caption-text" id="kob_3b">Scalar flux plotted along line B for the first Kobayashi benchmark.</span></p></div></div><p></p></div><div class="col s12 m12 l12"><div class="card moose-float" style="width:100%;margin-left:auto;margin-right:auto;halign:center" id="kob_3c"><div class="card-content"><picture class="materialboxed moose-image"><img src="../media/3D_kobayashi/kob_3_C_err.png"></img></picture><p class="moose-caption"><span class="moose-caption-heading">Figure 16: </span><span class="moose-caption-text" id="kob_3c">Scalar flux plotted along line C for the first Kobayashi benchmark.</span></p></div></div><p></p></div><p></p></div></section><section class="scrollspy" id="fddafa51-1a01-4812-bb69-694429b8ef01" data-section-level="2" data-section-text="References"><h2 id="references">References</h2><div class="moose-bibliography"><ol><li id="kobayashi">Keisuke Kobayashi, Naoki Sugimura, and Yasunobu Nagaya.
<span class="bibtex-protected">3D Radiation Transport Benchmark Problems and Results for Simple Geometries With Void Region</span>.
<em><span class="bibtex-protected">Progress in Nuclear Energy (New Series)</span></em>, 39(2):119–144, 2001.
<a href="https://doi.org/10.1016/S0149-1970(01)00007-5">doi:10.1016/S0149-1970(01)00007-5</a>.<a href="#6da0490e-e63f-43ef-bf86-c58d27c8a929" class="modal-trigger moose-bibtex-modal" style="padding-left:10px;">[BibTeX]</a><div class="modal" id="6da0490e-e63f-43ef-bf86-c58d27c8a929"><div class="modal-content"><pre style="line-height:1.25;"><code class="language-latex">@article{kobayashi,
    author = "Kobayashi, Keisuke and Sugimura, Naoki and Nagaya, Yasunobu",
    title = "{3D Radiation Transport Benchmark Problems and Results for Simple Geometries With Void Region}",
    journal = "{Progress in Nuclear Energy (New Series)}",
    volume = "39",
    number = "2",
    pages = "119--144",
    year = "2001",
    doi = "10.1016/S0149-1970(01)00007-5"
}
</code></pre></div></div></li></ol></div></section></section><div class="moose-modal modal" id="51f8b7b5-27e3-408c-a6bb-11c7822e3806"><div class="modal-content"><h4>(tutorials/3D_kobayashi/kobayashi_1.i)</h4><pre class="moose-pre"><code class="language-moose">[Mesh]
  [domain]
    type = CartesianMeshGenerator
    dim = 3
    dx = &#x27;10 40 50&#x27;
    dy = &#x27;10 40 50&#x27;
    dz = &#x27;10 40 50&#x27;
    ix = &#x27;1 4 5&#x27;
    iy = &#x27;1 4 5&#x27;
    iz = &#x27;1 4 5&#x27;
    subdomain_id = &#x27;
    2 0 1
    0 0 1
    1 1 1

    0 0 1
    0 0 1
    1 1 1

    1 1 1
    1 1 1
    1 1 1&#x27;
  []
  uniform_refine = 1
[]

[TransportSystems]
  [Neutron]
    num_groups = 1
    max_anisotropy = 0
    scheme = saaf_cfem
    particle_type = neutron

    order = FIRST
    family = LAGRANGE

    n_azimuthal = 5
    n_polar = 5

    vacuum_boundaries = &#x27;right top front&#x27;
    reflective_boundaries = &#x27;back bottom left&#x27;

    volumetric_source_blocks = &#x27;2&#x27;
    volumetric_source_moments = &#x27;1.0&#x27;
    volumetric_source_anisotropies = &#x27;0&#x27;
  []
[]

[TransportMaterials]
  [Shield]
    type = ConstantTransportMaterial
    transport_system = &#x27;Neutron&#x27;
    group_total = &#x27;0.1&#x27;
    group_scattering = &#x27;0.05&#x27;
    anisotropy = 0
    block = &#x27;1 2&#x27;
  []
  [Duct]
    type = ConstantTransportMaterial
    transport_system = &#x27;Neutron&#x27;
    group_total = &#x27;1e-4&#x27;
    group_scattering = &#x27;0.5e-4&#x27;
    anisotropy = 0
    block = &#x27;0&#x27;
  []
[]

[Executioner]
  type = Steady
  solve_type = PJFNK
  petsc_options_iname = &#x27;-pc_type -pc_hypre_type -ksp_gmres_restart&#x27;
  petsc_options_value = &#x27; hypre    boomeramg      100&#x27;
  l_max_its = 50
  nl_rel_tol = 1e-12

  automatic_scaling = true
  off_diagonals_in_auto_scaling = true
  compute_scaling_once = false
[]

[VectorPostprocessors]
  [Line_A]
    type = LineValueSampler
    variable = flux_moment_1_0_0
    start_point = &#x27;5.0 5.0  5.0&#x27;
    end_point   = &#x27;5.0 95.0 5.0&#x27;
    num_points = 10
    sort_by = y
  []

  [Line_B]
    type = LineValueSampler
    variable = flux_moment_1_0_0
    start_point = &#x27;5.0 5.0  5.0&#x27;
    end_point   = &#x27;95.0 95.0 95.0&#x27;
    num_points = 10
    sort_by = x
  []

  [Line_C]
    type = LineValueSampler
    variable = flux_moment_1_0_0
    start_point = &#x27;5.0  55.0 5.0&#x27;
    end_point   = &#x27;95.0 55.0 5.0&#x27;
    num_points = 10
    sort_by = x
  []
[]

[Outputs]
  exodus = true
  csv = true
  execute_on = &#x27;TIMESTEP_END&#x27;
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="moose-modal modal" id="e286de38-e0d1-4752-ad1f-9236ff38f746"><div class="modal-content"><h4>(tutorials/3D_kobayashi/kobayashi_1.i)</h4><pre class="moose-pre"><code class="language-moose">[Mesh]
  [domain]
    type = CartesianMeshGenerator
    dim = 3
    dx = &#x27;10 40 50&#x27;
    dy = &#x27;10 40 50&#x27;
    dz = &#x27;10 40 50&#x27;
    ix = &#x27;1 4 5&#x27;
    iy = &#x27;1 4 5&#x27;
    iz = &#x27;1 4 5&#x27;
    subdomain_id = &#x27;
    2 0 1
    0 0 1
    1 1 1

    0 0 1
    0 0 1
    1 1 1

    1 1 1
    1 1 1
    1 1 1&#x27;
  []
  uniform_refine = 1
[]

[TransportSystems]
  [Neutron]
    num_groups = 1
    max_anisotropy = 0
    scheme = saaf_cfem
    particle_type = neutron

    order = FIRST
    family = LAGRANGE

    n_azimuthal = 5
    n_polar = 5

    vacuum_boundaries = &#x27;right top front&#x27;
    reflective_boundaries = &#x27;back bottom left&#x27;

    volumetric_source_blocks = &#x27;2&#x27;
    volumetric_source_moments = &#x27;1.0&#x27;
    volumetric_source_anisotropies = &#x27;0&#x27;
  []
[]

[TransportMaterials]
  [Shield]
    type = ConstantTransportMaterial
    transport_system = &#x27;Neutron&#x27;
    group_total = &#x27;0.1&#x27;
    group_scattering = &#x27;0.05&#x27;
    anisotropy = 0
    block = &#x27;1 2&#x27;
  []
  [Duct]
    type = ConstantTransportMaterial
    transport_system = &#x27;Neutron&#x27;
    group_total = &#x27;1e-4&#x27;
    group_scattering = &#x27;0.5e-4&#x27;
    anisotropy = 0
    block = &#x27;0&#x27;
  []
[]

[Executioner]
  type = Steady
  solve_type = PJFNK
  petsc_options_iname = &#x27;-pc_type -pc_hypre_type -ksp_gmres_restart&#x27;
  petsc_options_value = &#x27; hypre    boomeramg      100&#x27;
  l_max_its = 50
  nl_rel_tol = 1e-12

  automatic_scaling = true
  off_diagonals_in_auto_scaling = true
  compute_scaling_once = false
[]

[VectorPostprocessors]
  [Line_A]
    type = LineValueSampler
    variable = flux_moment_1_0_0
    start_point = &#x27;5.0 5.0  5.0&#x27;
    end_point   = &#x27;5.0 95.0 5.0&#x27;
    num_points = 10
    sort_by = y
  []

  [Line_B]
    type = LineValueSampler
    variable = flux_moment_1_0_0
    start_point = &#x27;5.0 5.0  5.0&#x27;
    end_point   = &#x27;95.0 95.0 95.0&#x27;
    num_points = 10
    sort_by = x
  []

  [Line_C]
    type = LineValueSampler
    variable = flux_moment_1_0_0
    start_point = &#x27;5.0  55.0 5.0&#x27;
    end_point   = &#x27;95.0 55.0 5.0&#x27;
    num_points = 10
    sort_by = x
  []
[]

[Outputs]
  exodus = true
  csv = true
  execute_on = &#x27;TIMESTEP_END&#x27;
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="moose-modal modal" id="f5c9eeb2-d704-4c69-a43c-384df31434d1"><div class="modal-content"><h4>(tutorials/3D_kobayashi/kobayashi_1.i)</h4><pre class="moose-pre"><code class="language-moose">[Mesh]
  [domain]
    type = CartesianMeshGenerator
    dim = 3
    dx = &#x27;10 40 50&#x27;
    dy = &#x27;10 40 50&#x27;
    dz = &#x27;10 40 50&#x27;
    ix = &#x27;1 4 5&#x27;
    iy = &#x27;1 4 5&#x27;
    iz = &#x27;1 4 5&#x27;
    subdomain_id = &#x27;
    2 0 1
    0 0 1
    1 1 1

    0 0 1
    0 0 1
    1 1 1

    1 1 1
    1 1 1
    1 1 1&#x27;
  []
  uniform_refine = 1
[]

[TransportSystems]
  [Neutron]
    num_groups = 1
    max_anisotropy = 0
    scheme = saaf_cfem
    particle_type = neutron

    order = FIRST
    family = LAGRANGE

    n_azimuthal = 5
    n_polar = 5

    vacuum_boundaries = &#x27;right top front&#x27;
    reflective_boundaries = &#x27;back bottom left&#x27;

    volumetric_source_blocks = &#x27;2&#x27;
    volumetric_source_moments = &#x27;1.0&#x27;
    volumetric_source_anisotropies = &#x27;0&#x27;
  []
[]

[TransportMaterials]
  [Shield]
    type = ConstantTransportMaterial
    transport_system = &#x27;Neutron&#x27;
    group_total = &#x27;0.1&#x27;
    group_scattering = &#x27;0.05&#x27;
    anisotropy = 0
    block = &#x27;1 2&#x27;
  []
  [Duct]
    type = ConstantTransportMaterial
    transport_system = &#x27;Neutron&#x27;
    group_total = &#x27;1e-4&#x27;
    group_scattering = &#x27;0.5e-4&#x27;
    anisotropy = 0
    block = &#x27;0&#x27;
  []
[]

[Executioner]
  type = Steady
  solve_type = PJFNK
  petsc_options_iname = &#x27;-pc_type -pc_hypre_type -ksp_gmres_restart&#x27;
  petsc_options_value = &#x27; hypre    boomeramg      100&#x27;
  l_max_its = 50
  nl_rel_tol = 1e-12

  automatic_scaling = true
  off_diagonals_in_auto_scaling = true
  compute_scaling_once = false
[]

[VectorPostprocessors]
  [Line_A]
    type = LineValueSampler
    variable = flux_moment_1_0_0
    start_point = &#x27;5.0 5.0  5.0&#x27;
    end_point   = &#x27;5.0 95.0 5.0&#x27;
    num_points = 10
    sort_by = y
  []

  [Line_B]
    type = LineValueSampler
    variable = flux_moment_1_0_0
    start_point = &#x27;5.0 5.0  5.0&#x27;
    end_point   = &#x27;95.0 95.0 95.0&#x27;
    num_points = 10
    sort_by = x
  []

  [Line_C]
    type = LineValueSampler
    variable = flux_moment_1_0_0
    start_point = &#x27;5.0  55.0 5.0&#x27;
    end_point   = &#x27;95.0 55.0 5.0&#x27;
    num_points = 10
    sort_by = x
  []
[]

[Outputs]
  exodus = true
  csv = true
  execute_on = &#x27;TIMESTEP_END&#x27;
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="moose-modal modal" id="4c16ecbd-16ca-4aac-a8fb-cf1ebfc1a951"><div class="modal-content"><h4>(tutorials/3D_kobayashi/kobayashi_1.i)</h4><pre class="moose-pre"><code class="language-moose">[Mesh]
  [domain]
    type = CartesianMeshGenerator
    dim = 3
    dx = &#x27;10 40 50&#x27;
    dy = &#x27;10 40 50&#x27;
    dz = &#x27;10 40 50&#x27;
    ix = &#x27;1 4 5&#x27;
    iy = &#x27;1 4 5&#x27;
    iz = &#x27;1 4 5&#x27;
    subdomain_id = &#x27;
    2 0 1
    0 0 1
    1 1 1

    0 0 1
    0 0 1
    1 1 1

    1 1 1
    1 1 1
    1 1 1&#x27;
  []
  uniform_refine = 1
[]

[TransportSystems]
  [Neutron]
    num_groups = 1
    max_anisotropy = 0
    scheme = saaf_cfem
    particle_type = neutron

    order = FIRST
    family = LAGRANGE

    n_azimuthal = 5
    n_polar = 5

    vacuum_boundaries = &#x27;right top front&#x27;
    reflective_boundaries = &#x27;back bottom left&#x27;

    volumetric_source_blocks = &#x27;2&#x27;
    volumetric_source_moments = &#x27;1.0&#x27;
    volumetric_source_anisotropies = &#x27;0&#x27;
  []
[]

[TransportMaterials]
  [Shield]
    type = ConstantTransportMaterial
    transport_system = &#x27;Neutron&#x27;
    group_total = &#x27;0.1&#x27;
    group_scattering = &#x27;0.05&#x27;
    anisotropy = 0
    block = &#x27;1 2&#x27;
  []
  [Duct]
    type = ConstantTransportMaterial
    transport_system = &#x27;Neutron&#x27;
    group_total = &#x27;1e-4&#x27;
    group_scattering = &#x27;0.5e-4&#x27;
    anisotropy = 0
    block = &#x27;0&#x27;
  []
[]

[Executioner]
  type = Steady
  solve_type = PJFNK
  petsc_options_iname = &#x27;-pc_type -pc_hypre_type -ksp_gmres_restart&#x27;
  petsc_options_value = &#x27; hypre    boomeramg      100&#x27;
  l_max_its = 50
  nl_rel_tol = 1e-12

  automatic_scaling = true
  off_diagonals_in_auto_scaling = true
  compute_scaling_once = false
[]

[VectorPostprocessors]
  [Line_A]
    type = LineValueSampler
    variable = flux_moment_1_0_0
    start_point = &#x27;5.0 5.0  5.0&#x27;
    end_point   = &#x27;5.0 95.0 5.0&#x27;
    num_points = 10
    sort_by = y
  []

  [Line_B]
    type = LineValueSampler
    variable = flux_moment_1_0_0
    start_point = &#x27;5.0 5.0  5.0&#x27;
    end_point   = &#x27;95.0 95.0 95.0&#x27;
    num_points = 10
    sort_by = x
  []

  [Line_C]
    type = LineValueSampler
    variable = flux_moment_1_0_0
    start_point = &#x27;5.0  55.0 5.0&#x27;
    end_point   = &#x27;95.0 55.0 5.0&#x27;
    num_points = 10
    sort_by = x
  []
[]

[Outputs]
  exodus = true
  csv = true
  execute_on = &#x27;TIMESTEP_END&#x27;
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="moose-modal modal" id="188ca5ad-ab67-4604-8195-6e80947fcf6b"><div class="modal-content"><h4>(tutorials/3D_kobayashi/kobayashi_1.i)</h4><pre class="moose-pre"><code class="language-moose">[Mesh]
  [domain]
    type = CartesianMeshGenerator
    dim = 3
    dx = &#x27;10 40 50&#x27;
    dy = &#x27;10 40 50&#x27;
    dz = &#x27;10 40 50&#x27;
    ix = &#x27;1 4 5&#x27;
    iy = &#x27;1 4 5&#x27;
    iz = &#x27;1 4 5&#x27;
    subdomain_id = &#x27;
    2 0 1
    0 0 1
    1 1 1

    0 0 1
    0 0 1
    1 1 1

    1 1 1
    1 1 1
    1 1 1&#x27;
  []
  uniform_refine = 1
[]

[TransportSystems]
  [Neutron]
    num_groups = 1
    max_anisotropy = 0
    scheme = saaf_cfem
    particle_type = neutron

    order = FIRST
    family = LAGRANGE

    n_azimuthal = 5
    n_polar = 5

    vacuum_boundaries = &#x27;right top front&#x27;
    reflective_boundaries = &#x27;back bottom left&#x27;

    volumetric_source_blocks = &#x27;2&#x27;
    volumetric_source_moments = &#x27;1.0&#x27;
    volumetric_source_anisotropies = &#x27;0&#x27;
  []
[]

[TransportMaterials]
  [Shield]
    type = ConstantTransportMaterial
    transport_system = &#x27;Neutron&#x27;
    group_total = &#x27;0.1&#x27;
    group_scattering = &#x27;0.05&#x27;
    anisotropy = 0
    block = &#x27;1 2&#x27;
  []
  [Duct]
    type = ConstantTransportMaterial
    transport_system = &#x27;Neutron&#x27;
    group_total = &#x27;1e-4&#x27;
    group_scattering = &#x27;0.5e-4&#x27;
    anisotropy = 0
    block = &#x27;0&#x27;
  []
[]

[Executioner]
  type = Steady
  solve_type = PJFNK
  petsc_options_iname = &#x27;-pc_type -pc_hypre_type -ksp_gmres_restart&#x27;
  petsc_options_value = &#x27; hypre    boomeramg      100&#x27;
  l_max_its = 50
  nl_rel_tol = 1e-12

  automatic_scaling = true
  off_diagonals_in_auto_scaling = true
  compute_scaling_once = false
[]

[VectorPostprocessors]
  [Line_A]
    type = LineValueSampler
    variable = flux_moment_1_0_0
    start_point = &#x27;5.0 5.0  5.0&#x27;
    end_point   = &#x27;5.0 95.0 5.0&#x27;
    num_points = 10
    sort_by = y
  []

  [Line_B]
    type = LineValueSampler
    variable = flux_moment_1_0_0
    start_point = &#x27;5.0 5.0  5.0&#x27;
    end_point   = &#x27;95.0 95.0 95.0&#x27;
    num_points = 10
    sort_by = x
  []

  [Line_C]
    type = LineValueSampler
    variable = flux_moment_1_0_0
    start_point = &#x27;5.0  55.0 5.0&#x27;
    end_point   = &#x27;95.0 55.0 5.0&#x27;
    num_points = 10
    sort_by = x
  []
[]

[Outputs]
  exodus = true
  csv = true
  execute_on = &#x27;TIMESTEP_END&#x27;
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="moose-modal modal" id="f0ab6b33-a4f7-483d-8d28-43f5e94c8b5c"><div class="modal-content"><h4>(tutorials/3D_kobayashi/kobayashi_1.i)</h4><pre class="moose-pre"><code class="language-moose">[Mesh]
  [domain]
    type = CartesianMeshGenerator
    dim = 3
    dx = &#x27;10 40 50&#x27;
    dy = &#x27;10 40 50&#x27;
    dz = &#x27;10 40 50&#x27;
    ix = &#x27;1 4 5&#x27;
    iy = &#x27;1 4 5&#x27;
    iz = &#x27;1 4 5&#x27;
    subdomain_id = &#x27;
    2 0 1
    0 0 1
    1 1 1

    0 0 1
    0 0 1
    1 1 1

    1 1 1
    1 1 1
    1 1 1&#x27;
  []
  uniform_refine = 1
[]

[TransportSystems]
  [Neutron]
    num_groups = 1
    max_anisotropy = 0
    scheme = saaf_cfem
    particle_type = neutron

    order = FIRST
    family = LAGRANGE

    n_azimuthal = 5
    n_polar = 5

    vacuum_boundaries = &#x27;right top front&#x27;
    reflective_boundaries = &#x27;back bottom left&#x27;

    volumetric_source_blocks = &#x27;2&#x27;
    volumetric_source_moments = &#x27;1.0&#x27;
    volumetric_source_anisotropies = &#x27;0&#x27;
  []
[]

[TransportMaterials]
  [Shield]
    type = ConstantTransportMaterial
    transport_system = &#x27;Neutron&#x27;
    group_total = &#x27;0.1&#x27;
    group_scattering = &#x27;0.05&#x27;
    anisotropy = 0
    block = &#x27;1 2&#x27;
  []
  [Duct]
    type = ConstantTransportMaterial
    transport_system = &#x27;Neutron&#x27;
    group_total = &#x27;1e-4&#x27;
    group_scattering = &#x27;0.5e-4&#x27;
    anisotropy = 0
    block = &#x27;0&#x27;
  []
[]

[Executioner]
  type = Steady
  solve_type = PJFNK
  petsc_options_iname = &#x27;-pc_type -pc_hypre_type -ksp_gmres_restart&#x27;
  petsc_options_value = &#x27; hypre    boomeramg      100&#x27;
  l_max_its = 50
  nl_rel_tol = 1e-12

  automatic_scaling = true
  off_diagonals_in_auto_scaling = true
  compute_scaling_once = false
[]

[VectorPostprocessors]
  [Line_A]
    type = LineValueSampler
    variable = flux_moment_1_0_0
    start_point = &#x27;5.0 5.0  5.0&#x27;
    end_point   = &#x27;5.0 95.0 5.0&#x27;
    num_points = 10
    sort_by = y
  []

  [Line_B]
    type = LineValueSampler
    variable = flux_moment_1_0_0
    start_point = &#x27;5.0 5.0  5.0&#x27;
    end_point   = &#x27;95.0 95.0 95.0&#x27;
    num_points = 10
    sort_by = x
  []

  [Line_C]
    type = LineValueSampler
    variable = flux_moment_1_0_0
    start_point = &#x27;5.0  55.0 5.0&#x27;
    end_point   = &#x27;95.0 55.0 5.0&#x27;
    num_points = 10
    sort_by = x
  []
[]

[Outputs]
  exodus = true
  csv = true
  execute_on = &#x27;TIMESTEP_END&#x27;
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="moose-modal modal" id="ef4de371-c4f8-4a3b-a11b-01b7c2f1e3e8"><div class="modal-content"><h4>(tutorials/3D_kobayashi/kobayashi_2.i)</h4><pre class="moose-pre"><code class="language-moose">[Mesh]
  [domain]
    type = CartesianMeshGenerator
    dim = 3
    dx = &#x27;10 50&#x27;
    dy = &#x27;10 90&#x27;
    dz = &#x27;10 50&#x27;
    ix = &#x27;1 5&#x27;
    iy = &#x27;1 9&#x27;
    iz = &#x27;1 5&#x27;
    subdomain_id = &#x27;
    2 1
    0 1

    1 1
    1 1&#x27;
  []
  uniform_refine = 1
[]

[TransportSystems]
  [Neutron]
    num_groups = 1
    max_anisotropy = 0
    scheme = saaf_cfem
    particle_type = neutron

    order = FIRST
    family = LAGRANGE

    n_azimuthal = 5
    n_polar = 5

    vacuum_boundaries = &#x27;right top front&#x27;
    reflective_boundaries = &#x27;back bottom left&#x27;

    volumetric_source_blocks = &#x27;2&#x27;
    volumetric_source_moments = &#x27;1.0&#x27;
    volumetric_source_anisotropies = &#x27;0&#x27;
  []
[]

[TransportMaterials]
  [Shield]
    type = ConstantTransportMaterial
    transport_system = &#x27;Neutron&#x27;
    group_total = &#x27;0.1&#x27;
    group_scattering = &#x27;0.05&#x27;
    anisotropy = 0
    block = &#x27;1 2&#x27;
  []
  [Duct]
    type = ConstantTransportMaterial
    transport_system = &#x27;Neutron&#x27;
    group_total = &#x27;1e-4&#x27;
    group_scattering = &#x27;0.5e-4&#x27;
    anisotropy = 0
    block = &#x27;0&#x27;
  []
[]

[Executioner]
  type = Steady
  solve_type = PJFNK
  petsc_options_iname = &#x27;-pc_type -pc_hypre_type -ksp_gmres_restart&#x27;
  petsc_options_value = &#x27; hypre    boomeramg      100&#x27;
  l_max_its = 50
  nl_rel_tol = 1e-12

  automatic_scaling = true
  off_diagonals_in_auto_scaling = true
  compute_scaling_once = false
[]

[VectorPostprocessors]
  [Line_A]
    type = LineValueSampler
    variable = flux_moment_1_0_0
    start_point = &#x27;5.0 5.0  5.0&#x27;
    end_point   = &#x27;5.0 95.0 5.0&#x27;
    num_points = 10
    sort_by = y
  []

  [Line_B]
    type = LineValueSampler
    variable = flux_moment_1_0_0
    start_point = &#x27;5.0  95.0 5.0&#x27;
    end_point   = &#x27;55.0 95.0 5.0&#x27;
    num_points = 6
    sort_by = x
  []
[]

[Outputs]
  exodus = true
  csv = true
  execute_on = &#x27;TIMESTEP_END&#x27;
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="moose-modal modal" id="fe6249d2-8f25-4fab-bdd8-40993049acd3"><div class="modal-content"><h4>(tutorials/3D_kobayashi/kobayashi_2.i)</h4><pre class="moose-pre"><code class="language-moose">[Mesh]
  [domain]
    type = CartesianMeshGenerator
    dim = 3
    dx = &#x27;10 50&#x27;
    dy = &#x27;10 90&#x27;
    dz = &#x27;10 50&#x27;
    ix = &#x27;1 5&#x27;
    iy = &#x27;1 9&#x27;
    iz = &#x27;1 5&#x27;
    subdomain_id = &#x27;
    2 1
    0 1

    1 1
    1 1&#x27;
  []
  uniform_refine = 1
[]

[TransportSystems]
  [Neutron]
    num_groups = 1
    max_anisotropy = 0
    scheme = saaf_cfem
    particle_type = neutron

    order = FIRST
    family = LAGRANGE

    n_azimuthal = 5
    n_polar = 5

    vacuum_boundaries = &#x27;right top front&#x27;
    reflective_boundaries = &#x27;back bottom left&#x27;

    volumetric_source_blocks = &#x27;2&#x27;
    volumetric_source_moments = &#x27;1.0&#x27;
    volumetric_source_anisotropies = &#x27;0&#x27;
  []
[]

[TransportMaterials]
  [Shield]
    type = ConstantTransportMaterial
    transport_system = &#x27;Neutron&#x27;
    group_total = &#x27;0.1&#x27;
    group_scattering = &#x27;0.05&#x27;
    anisotropy = 0
    block = &#x27;1 2&#x27;
  []
  [Duct]
    type = ConstantTransportMaterial
    transport_system = &#x27;Neutron&#x27;
    group_total = &#x27;1e-4&#x27;
    group_scattering = &#x27;0.5e-4&#x27;
    anisotropy = 0
    block = &#x27;0&#x27;
  []
[]

[Executioner]
  type = Steady
  solve_type = PJFNK
  petsc_options_iname = &#x27;-pc_type -pc_hypre_type -ksp_gmres_restart&#x27;
  petsc_options_value = &#x27; hypre    boomeramg      100&#x27;
  l_max_its = 50
  nl_rel_tol = 1e-12

  automatic_scaling = true
  off_diagonals_in_auto_scaling = true
  compute_scaling_once = false
[]

[VectorPostprocessors]
  [Line_A]
    type = LineValueSampler
    variable = flux_moment_1_0_0
    start_point = &#x27;5.0 5.0  5.0&#x27;
    end_point   = &#x27;5.0 95.0 5.0&#x27;
    num_points = 10
    sort_by = y
  []

  [Line_B]
    type = LineValueSampler
    variable = flux_moment_1_0_0
    start_point = &#x27;5.0  95.0 5.0&#x27;
    end_point   = &#x27;55.0 95.0 5.0&#x27;
    num_points = 6
    sort_by = x
  []
[]

[Outputs]
  exodus = true
  csv = true
  execute_on = &#x27;TIMESTEP_END&#x27;
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="moose-modal modal" id="4db72a73-11a2-4218-9152-ffa5a575ccb6"><div class="modal-content"><h4>(tutorials/3D_kobayashi/kobayashi_3.i)</h4><pre class="moose-pre"><code class="language-moose">[Mesh]
  [domain]
    type = CartesianMeshGenerator
    dim = 3
    dx = &#x27;10 20 10 20&#x27;
    dy = &#x27;10 40 10 40&#x27;
    dz = &#x27;10 20 10 20&#x27;
    ix = &#x27;1 2 1 2&#x27;
    iy = &#x27;1 4 1 4&#x27;
    iz = &#x27;1 2 1 2&#x27;
    subdomain_id = &#x27;
    2 1 1 1
    0 1 1 1
    0 0 0 1
    1 1 1 1

    1 1 1 1
    1 1 1 1
    1 1 0 1
    1 1 1 1

    1 1 1 1
    1 1 1 1
    1 1 0 1
    1 1 0 1

    1 1 1 1
    1 1 1 1
    1 1 1 1
    1 1 1 1&#x27;
  []
  uniform_refine = 1
[]

[TransportSystems]
  [Neutron]
    num_groups = 1
    max_anisotropy = 0
    scheme = saaf_cfem
    particle_type = neutron

    order = FIRST
    family = LAGRANGE

    n_azimuthal = 5
    n_polar = 5

    vacuum_boundaries = &#x27;right top front&#x27;
    reflective_boundaries = &#x27;back bottom left&#x27;

    volumetric_source_blocks = &#x27;2&#x27;
    volumetric_source_moments = &#x27;1.0&#x27;
    volumetric_source_anisotropies = &#x27;0&#x27;
  []
[]

[TransportMaterials]
  [Shield]
    type = ConstantTransportMaterial
    transport_system = &#x27;Neutron&#x27;
    group_total = &#x27;0.1&#x27;
    group_scattering = &#x27;0.05&#x27;
    anisotropy = 0
    block = &#x27;1 2&#x27;
  []
  [Duct]
    type = ConstantTransportMaterial
    transport_system = &#x27;Neutron&#x27;
    group_total = &#x27;1.0e-4&#x27;
    group_scattering = &#x27;0.5e-4&#x27;
    anisotropy = 0
    block = &#x27;0&#x27;
  []
[]

[Executioner]
  type = Steady
  solve_type = PJFNK
  petsc_options_iname = &#x27;-pc_type -pc_hypre_type -ksp_gmres_restart&#x27;
  petsc_options_value = &#x27; hypre    boomeramg      100&#x27;
  l_max_its = 50
  nl_rel_tol = 1e-12

  automatic_scaling = true
  off_diagonals_in_auto_scaling = true
  compute_scaling_once = false
[]

[VectorPostprocessors]
  [Line_A]
    type = LineValueSampler
    variable = flux_moment_1_0_0
    start_point = &#x27;5.0 5.0  5.0&#x27;
    end_point   = &#x27;5.0 95.0 5.0&#x27;
    num_points = 10
    sort_by = y
  []

  [Line_B]
    type = LineValueSampler
    variable = flux_moment_1_0_0
    start_point = &#x27;5.0  55.0 5.0&#x27;
    end_point   = &#x27;55.0 55.0 5.0&#x27;
    num_points = 6
    sort_by = x
  []

  [Line_C]
    type = LineValueSampler
    variable = flux_moment_1_0_0
    start_point = &#x27;5.0  95.0 35.0&#x27;
    end_point   = &#x27;55.0 95.0 35.0&#x27;
    num_points = 6
    sort_by = x
  []
[]

[Outputs]
  exodus = true
  csv = true
  execute_on = TIMESTEP_END
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="moose-modal modal" id="6f0f6a28-6ca9-4a40-a5ad-61ab2f2d025b"><div class="modal-content"><h4>(tutorials/3D_kobayashi/kobayashi_3.i)</h4><pre class="moose-pre"><code class="language-moose">[Mesh]
  [domain]
    type = CartesianMeshGenerator
    dim = 3
    dx = &#x27;10 20 10 20&#x27;
    dy = &#x27;10 40 10 40&#x27;
    dz = &#x27;10 20 10 20&#x27;
    ix = &#x27;1 2 1 2&#x27;
    iy = &#x27;1 4 1 4&#x27;
    iz = &#x27;1 2 1 2&#x27;
    subdomain_id = &#x27;
    2 1 1 1
    0 1 1 1
    0 0 0 1
    1 1 1 1

    1 1 1 1
    1 1 1 1
    1 1 0 1
    1 1 1 1

    1 1 1 1
    1 1 1 1
    1 1 0 1
    1 1 0 1

    1 1 1 1
    1 1 1 1
    1 1 1 1
    1 1 1 1&#x27;
  []
  uniform_refine = 1
[]

[TransportSystems]
  [Neutron]
    num_groups = 1
    max_anisotropy = 0
    scheme = saaf_cfem
    particle_type = neutron

    order = FIRST
    family = LAGRANGE

    n_azimuthal = 5
    n_polar = 5

    vacuum_boundaries = &#x27;right top front&#x27;
    reflective_boundaries = &#x27;back bottom left&#x27;

    volumetric_source_blocks = &#x27;2&#x27;
    volumetric_source_moments = &#x27;1.0&#x27;
    volumetric_source_anisotropies = &#x27;0&#x27;
  []
[]

[TransportMaterials]
  [Shield]
    type = ConstantTransportMaterial
    transport_system = &#x27;Neutron&#x27;
    group_total = &#x27;0.1&#x27;
    group_scattering = &#x27;0.05&#x27;
    anisotropy = 0
    block = &#x27;1 2&#x27;
  []
  [Duct]
    type = ConstantTransportMaterial
    transport_system = &#x27;Neutron&#x27;
    group_total = &#x27;1.0e-4&#x27;
    group_scattering = &#x27;0.5e-4&#x27;
    anisotropy = 0
    block = &#x27;0&#x27;
  []
[]

[Executioner]
  type = Steady
  solve_type = PJFNK
  petsc_options_iname = &#x27;-pc_type -pc_hypre_type -ksp_gmres_restart&#x27;
  petsc_options_value = &#x27; hypre    boomeramg      100&#x27;
  l_max_its = 50
  nl_rel_tol = 1e-12

  automatic_scaling = true
  off_diagonals_in_auto_scaling = true
  compute_scaling_once = false
[]

[VectorPostprocessors]
  [Line_A]
    type = LineValueSampler
    variable = flux_moment_1_0_0
    start_point = &#x27;5.0 5.0  5.0&#x27;
    end_point   = &#x27;5.0 95.0 5.0&#x27;
    num_points = 10
    sort_by = y
  []

  [Line_B]
    type = LineValueSampler
    variable = flux_moment_1_0_0
    start_point = &#x27;5.0  55.0 5.0&#x27;
    end_point   = &#x27;55.0 55.0 5.0&#x27;
    num_points = 6
    sort_by = x
  []

  [Line_C]
    type = LineValueSampler
    variable = flux_moment_1_0_0
    start_point = &#x27;5.0  95.0 35.0&#x27;
    end_point   = &#x27;55.0 95.0 35.0&#x27;
    num_points = 6
    sort_by = x
  []
[]

[Outputs]
  exodus = true
  csv = true
  execute_on = TIMESTEP_END
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div></div><div class="col hide-on-med-and-down l2"><div class="toc-wrapper pin-top"><ul class="section table-of-contents"><li><a href="#7b7682e8-0206-423a-9840-e331f05c1442" class="tooltipped" data-position="left" data-tooltip="Common Material Properties">Common Material Properties</a></li><li><a href="#32d24731-87de-4bd7-a4cc-2f4c787c3b54" class="tooltipped" data-position="left" data-tooltip="Volume Source in a Cubic Shield">Volume Source in a Cubic Shield</a></li><li><a href="#31f932fa-a383-437e-91e4-f8152f55f975" class="tooltipped" data-position="left" data-tooltip="Straight Duct">Straight Duct</a></li><li><a href="#22363293-c9ae-46db-adda-6cc6b8d2e51d" class="tooltipped" data-position="left" data-tooltip="Dog - Legged Duct">Dog - Legged Duct</a></li><li><a href="#fddafa51-1a01-4812-bb69-694429b8ef01" class="tooltipped" data-position="left" data-tooltip="References">References</a></li></ul></div></div></div></div></main></div></body><script type="text/javascript" src="../contrib/materialize/materialize.min.js"></script><script type="text/javascript" src="../contrib/clipboard/clipboard.min.js"></script><script type="text/javascript" src="../contrib/prism/prism.min.js"></script><script type="text/javascript" src="../js/init.js"></script><script type="text/javascript" src="../js/navigation.js"></script><script type="text/javascript" src="../contrib/fuse/fuse.min.js"></script><script type="text/javascript" src="../js/search_index.js"></script><script type="text/javascript" src="../js/sqa_moose.js"></script><script type="text/javascript" src="../js/moose_input_parser.js"></script>
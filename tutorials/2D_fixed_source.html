<!DOCTYPE html><head><meta charset="UTF-8"><title>Simple Fixed Source Problems | Gnat</title><link href="../contrib/materialize/materialize.min.css" type="text/css" rel="stylesheet" media="screen,projection"></link><link href="../contrib/prism/prism.min.css" type="text/css" rel="stylesheet"></link><link href="../css/moose.css" type="text/css" rel="stylesheet"></link><link href="../css/devel_moose.css" type="text/css" rel="stylesheet"></link><link href="../css/alert_moose.css" type="text/css" rel="stylesheet"></link><link href="../css/content_moose.css" type="text/css" rel="stylesheet"></link><link href="../css/sqa_moose.css" type="text/css" rel="stylesheet"></link><link href="../css/civet_moose.css" type="text/css" rel="stylesheet"></link><link href="../contrib/katex/katex.min.css" type="text/css" rel="stylesheet"></link><link href="../css/katex_moose.css" type="text/css" rel="stylesheet"></link><script type="text/javascript" src="../contrib/jquery/jquery.min.js"></script><script type="text/javascript" src="../contrib/katex/katex.min.js"></script></head><body><div class="page-wrap"><header><nav><div class="nav-wrapper container"><a href="../index.html" class="left moose-logo hide-on-med-and-down" id="home-button">Gnat</a><a href="https://github.com/OTU-Center-for-SMRs/gnat" class="right"><img src="../media/framework/github-logo.png" class="github-mark"></img><img src="../media/framework/github-mark.png" class="github-logo"></img></a><ul class="right hide-on-med-and-down"><li><a href="#!" class="dropdown-trigger" data-target="9d7f4c88-48d1-45f0-aeda-732530a45a1a" data-constrainWidth="false">Getting Started<i class="material-icons right">arrow_drop_down</i></a></li><li><a href="#!" class="dropdown-trigger" data-target="77b63801-3198-4bd2-a7e6-01b1b133a27e" data-constrainWidth="false">Theory and Implementation<i class="material-icons right">arrow_drop_down</i></a></li><li><a href="#!" class="dropdown-trigger" data-target="c16bae4e-bfa6-4511-9593-b0f54e2ad424" data-constrainWidth="false">Documentation<i class="material-icons right">arrow_drop_down</i></a></li><li><a href="../publications.html">Publications</a></li><li><a href="../contact.html">Contact</a></li></ul><a href="#" class="sidenav-trigger" data-target="e549bef5-3905-49d1-a576-57c7a84d4951"><i class="material-icons">menu</i></a><ul class="sidenav" id="e549bef5-3905-49d1-a576-57c7a84d4951"><li><a href="#!" class="dropdown-trigger" data-target="5f7c2bbe-c473-4891-a9bf-a45feaf4f92f" data-constrainWidth="false">Getting Started<i class="material-icons right">arrow_drop_down</i></a></li><li><a href="#!" class="dropdown-trigger" data-target="bde6252a-b9f7-4592-8bbc-0f430f53297b" data-constrainWidth="false">Theory and Implementation<i class="material-icons right">arrow_drop_down</i></a></li><li><a href="#!" class="dropdown-trigger" data-target="e9fea606-2e0e-494c-b95f-9d4abd9199f2" data-constrainWidth="false">Documentation<i class="material-icons right">arrow_drop_down</i></a></li><li><a href="../publications.html">Publications</a></li><li><a href="../contact.html">Contact</a></li></ul><a href="#moose-search" class="modal-trigger"><i class="material-icons">search</i></a></div><ul class="dropdown-content" id="9d7f4c88-48d1-45f0-aeda-732530a45a1a"><li><a href="../installation/index.html">Installation</a></li><li><a href="index.html">Tutorials</a></li></ul><ul class="dropdown-content" id="77b63801-3198-4bd2-a7e6-01b1b133a27e"><li><a href="../about/radiation_transport.html">Radiation Transport</a></li><li><a href="../about/mobile_depletion.html">Fluid Depletion</a></li><li><a href="../about/implementation.html">Implementation</a></li></ul><ul class="dropdown-content" id="c16bae4e-bfa6-4511-9593-b0f54e2ad424"><li><a href="../source/index.html">Gnat Source Pages</a></li><li><a href="https://mooseframework.inl.gov/source/index.html">MOOSE Source Pages</a></li></ul><ul class="dropdown-content" id="5f7c2bbe-c473-4891-a9bf-a45feaf4f92f"><li><a href="../installation/index.html">Installation</a></li><li><a href="index.html">Tutorials</a></li></ul><ul class="dropdown-content" id="bde6252a-b9f7-4592-8bbc-0f430f53297b"><li><a href="../about/radiation_transport.html">Radiation Transport</a></li><li><a href="../about/mobile_depletion.html">Fluid Depletion</a></li><li><a href="../about/implementation.html">Implementation</a></li></ul><ul class="dropdown-content" id="e9fea606-2e0e-494c-b95f-9d4abd9199f2"><li><a href="../source/index.html">Gnat Source Pages</a></li><li><a href="https://mooseframework.inl.gov/source/index.html">MOOSE Source Pages</a></li></ul></nav><div class="modal modal-fixed-footer moose-search-modal" id="moose-search"><div class="modal-content container moose-search-modal-content"><div class="row"><div class="col l12"><div class="input-field"><input type_="text" onkeyup="mooseSearch()" placeholder="/index.md" id="moose-search-box"></input></div></div><div><div class="col s12" id="moose-search-results"></div></div></div></div><div class="modal-footer"><a href="#!" class="modal-close btn-flat">Close</a></div></div></header><main class="main"><div class="container"><div class="row"><div class="col hide-on-med-and-down l12"><nav class="breadcrumb-nav"><div class="nav-wrapper"><a href="." class="breadcrumb">tutorials</a><a href="#" class="breadcrumb">2D_fixed_source</a></div></nav></div></div><div class="row"><div class="moose-content col s12 m12 l10"><section id="5fd1c686-2718-4b74-9b81-9a193cecbea0" data-section-level="1" data-section-text="Simple Fixed - Source Problems"><h1 id="simple-fixed-source-problems">Simple Fixed-Source Problems</h1><p>In this tutorial, you will learn:</p><ol class="browser-default" start="1"><li><p>How to model 2D shielding problems in Gnat; </p></li><li><p>How to provide multi-group material properties; </p></li><li><p>How to specify point and surface sources.</p></li></ol><p>To access this tutorial,</p><pre class="moose-pre"><code class="language-bash">
cd gnat/tutorials/2D_fixed_source
</code></pre><section class="scrollspy" id="bcef042a-8f8b-47c5-8042-a7376307d947" data-section-level="2" data-section-text="Geometry and Material Properties"><h2 id="geometry-and-material-properties">Geometry and Material Properties</h2><p>This problem is one where an isotropic neutron point source is placed in the middle of a <span class="moose-katex-inline-equation" id="moose-equation-080c07c1-2d44-463d-94a7-e5d258f41fec"><script>var element = document.getElementById("moose-equation-080c07c1-2d44-463d-94a7-e5d258f41fec");katex.render("10\\text{ cm }\\times 10\\text{ cm }", element, {displayMode:false,throwOnError:false});</script></span> 2D domain that scatters neutrons isotropically and absorbs neutrons. The point source emits at a constant rate of <span class="moose-katex-inline-equation" id="moose-equation-da08890a-6fdc-478a-8dfa-cd02ec789c13"><script>var element = document.getElementById("moose-equation-da08890a-6fdc-478a-8dfa-cd02ec789c13");katex.render("1\\times 10^{3}\\text{ s}^{-1}", element, {displayMode:false,throwOnError:false});</script></span> into a single energy group. Vacuum boundaries surround the domain on all four sides and the problem is at steady-state. The material has <span class="moose-katex-inline-equation" id="moose-equation-d4ff9828-0851-4573-9eb3-c16a9cc3c91a"><script>var element = document.getElementById("moose-equation-d4ff9828-0851-4573-9eb3-c16a9cc3c91a");katex.render("\\Sigma_{t} = 2.0", element, {displayMode:false,throwOnError:false});</script></span> cm<span class="moose-katex-inline-equation" id="moose-equation-9bca811f-d2ea-4093-829e-38a5d7c6e654"><script>var element = document.getElementById("moose-equation-9bca811f-d2ea-4093-829e-38a5d7c6e654");katex.render("^{-1}", element, {displayMode:false,throwOnError:false});</script></span> and <span class="moose-katex-inline-equation" id="moose-equation-be8dcda9-eb77-4ac0-bfd7-dab04675be33"><script>var element = document.getElementById("moose-equation-be8dcda9-eb77-4ac0-bfd7-dab04675be33");katex.render("\\Sigma_{s} = 1.0", element, {displayMode:false,throwOnError:false});</script></span> cm<span class="moose-katex-inline-equation" id="moose-equation-64841a8c-425f-4469-9649-e4a880975f1f"><script>var element = document.getElementById("moose-equation-64841a8c-425f-4469-9649-e4a880975f1f");katex.render("^{-1}", element, {displayMode:false,throwOnError:false});</script></span>.</p></section><section class="scrollspy" id="5ce259cb-86bd-458f-8ee7-e71f56aecfbf" data-section-level="2" data-section-text="The Neutronics Input File"><h2 id="the-neutronics-input-file">The Neutronics Input File</h2><p>Like any problem which is solved with the finite element method, the first step in using Gnat for neutron transport is to declare a mesh. For a simple case like this one the built-in mesh generators in Moose can be used:</p><pre class="moose-pre" style="max-height:350px;"><code class="language-moose">[Mesh]
  [domain]
    type = CartesianMeshGenerator&lt;&lt;&lt;{&quot;description&quot;: &quot;This CartesianMeshGenerator creates a non-uniform Cartesian mesh.&quot;}&gt;&gt;&gt;
    dim&lt;&lt;&lt;{&quot;description&quot;: &quot;The dimension of the mesh to be generated&quot;}&gt;&gt;&gt; = 2
    dx&lt;&lt;&lt;{&quot;description&quot;: &quot;Intervals in the X direction&quot;}&gt;&gt;&gt; = 10
    dy&lt;&lt;&lt;{&quot;description&quot;: &quot;Intervals in the Y direction (required when dim&gt;1 otherwise ignored)&quot;}&gt;&gt;&gt; = 10
    ix&lt;&lt;&lt;{&quot;description&quot;: &quot;Number of grids in all intervals in the X direction (default to all one)&quot;}&gt;&gt;&gt; = 101
    iy&lt;&lt;&lt;{&quot;description&quot;: &quot;Number of grids in all intervals in the Y direction (default to all one)&quot;}&gt;&gt;&gt; = 101
  []
[]</code></pre><a class="moose-source-filename tooltipped modal-trigger" href="#68e0d15f-c10b-4a81-88e4-0ca5960a365d">(tutorials/2D_fixed_source/2D_point_source.i)</a><p>The <a href="https://mooseframework.inl.gov/source/meshgenerators/CartesianMeshGenerator.html">CartesianMeshGenerator</a> object generates simple cartesian meshes in 1D, 2D or 3D. <code>dim = 2</code> is set to let the mesh generator know that a 2D cartesian mesh is required. <code>dx = 10</code> and <code>dy = 10</code> set the size of the mesh to 10 cm in both x and y. Finally, <code>ix = 100</code> and <code>iy = 100</code> indicate that the mesh should be subdivided into 100 elements along both the x and y axis. The result is shown in <a class="moose-float-reference" href="#2D_problem_mesh">Figure 1</a>:</p><div class="card moose-float" style="width:40%;margin-left:auto;margin-right:auto;halign:center" id="2D_problem_mesh"><div class="card-content"><picture class="materialboxed moose-image"><img src="../media/2D_fixed_source/mesh.png"></img></picture><p class="moose-caption"><span class="moose-caption-heading">Figure 1: </span><span class="moose-caption-text" id="2D_problem_mesh">2D cartesian mesh for the 2D point source problem.</span></p></div></div><p>The next step in solving radiation transport problems is to declare a <code>TransportSystem</code> block. This is short-cut syntax that sets up all of the kernels and variables necessary for transport calculations along many directions for many energy groups, which minimizes the length of your Gnat input file.</p><pre class="moose-pre" style="max-height:350px;"><code class="language-moose">[TransportSystems&lt;&lt;&lt;{&quot;href&quot;: &quot;../syntax/TransportSystems/index.html&quot;}&gt;&gt;&gt;]
  [Neutron]
    num_groups&lt;&lt;&lt;{&quot;description&quot;: &quot;The number of spectral energy groups in the problem.&quot;}&gt;&gt;&gt; = 1
    max_anisotropy&lt;&lt;&lt;{&quot;description&quot;: &quot;The maximum degree of anisotropy to evaluate. Defaults to 0 for isotropic scattering.&quot;}&gt;&gt;&gt; = 0
    scheme&lt;&lt;&lt;{&quot;description&quot;: &quot;The discretization and stabilization scheme for the transport equation.&quot;}&gt;&gt;&gt; = saaf_cfem
    particle_type&lt;&lt;&lt;{&quot;description&quot;: &quot;The type of particle to be consuming material property data.&quot;}&gt;&gt;&gt; = neutron

    order&lt;&lt;&lt;{&quot;description&quot;: &quot;Specifies the order of the FE shape function to use for this variable (additional orders not listed are allowed).&quot;}&gt;&gt;&gt; = FIRST
    family&lt;&lt;&lt;{&quot;description&quot;: &quot;Specifies the family of FE shape functions to use for this variable.&quot;}&gt;&gt;&gt; = LAGRANGE

    n_azimuthal&lt;&lt;&lt;{&quot;description&quot;: &quot;Number of Chebyshev azimuthal quadrature points in a single octant of the unit sphere. Defaults to 3.&quot;}&gt;&gt;&gt; = 2
    n_polar&lt;&lt;&lt;{&quot;description&quot;: &quot;Number of Legendre polar quadrature points in a single octant of the unit sphere. Defaults to 3.&quot;}&gt;&gt;&gt; = 2

    vacuum_boundaries&lt;&lt;&lt;{&quot;description&quot;: &quot;The boundaries to apply vacuum boundary conditions.&quot;}&gt;&gt;&gt; = &#x27;left right top bottom&#x27;

    point_source_locations&lt;&lt;&lt;{&quot;description&quot;: &quot;The locations of all isotropic point sources in the problem space.&quot;}&gt;&gt;&gt; = &#x27;5.0 5.0 0.0&#x27;
    point_source_moments&lt;&lt;&lt;{&quot;description&quot;: &quot;A double vector containing a list of external source moments for all point particle sources. The external vector should correspond with the order of &#x27;point_source_locations&#x27;.&quot;}&gt;&gt;&gt; = &#x27;1e3&#x27;
    point_source_anisotropies&lt;&lt;&lt;{&quot;description&quot;: &quot;The anisotropies of the point sources. The vector should correspond with the order of &#x27;point_source_locations&#x27;&quot;}&gt;&gt;&gt; = &#x27;0&#x27;
    scale_sources&lt;&lt;&lt;{&quot;description&quot;: &quot;If the external fixed sources should be scaled such that each source moment is divided by the maximum source moment.&quot;}&gt;&gt;&gt; = true
  []
[]</code></pre><a class="moose-source-filename tooltipped modal-trigger" href="#82ab96e4-bca5-44f0-a8e2-321a2bb44ab5">(tutorials/2D_fixed_source/2D_point_source.i)</a><p>To start, <code>num_groups = 1</code> specifies that the transport simulation should only consider a single neutron group although more can be specified at the cost of increased computational complexity. <code>max_anisotropy = 0</code> tells the transport simulation to only evaluate the 0th-order moment of the angular flux, which is more than enough for this case as scattering is isotropic. <code>scheme = saaf_cfem</code> states that the self-adjoint angular flux stabilization scheme is requested. In accordance with that choice, continuous basis functions in the form of first-order (<code>order = FIRST</code>) Lagrange (<code>family = LAGRANGE</code>) functions are used. The number of angular directions are specified with <code>n_azimuthal = 2</code> and <code>n_polar = 2</code>, and vacuum boundaries are specified for all sides with <code>vacuum_boundaries = &#x27;left right top bottom&#x27;</code>. Finally, the point source is specified with a location at (5.0, 5.0, 5.0) with an emission intensity of 1000 n/s emitting into the single energy group. In addition to specifying the point source, we also set <code>scale_sources = true</code> which divides all source moments by the largest moment value. This rescales the fixed source problem such that the largest source moment is unity, improving the stability of the finite element solve.</p><p>Next, the material properties of the domain must be specified. Gnat does this through a system implemented for transport problems known as <code>TransportMaterials</code>:</p><pre class="moose-pre" style="max-height:350px;"><code class="language-moose">[TransportMaterials&lt;&lt;&lt;{&quot;href&quot;: &quot;../syntax/TransportMaterials/index.html&quot;}&gt;&gt;&gt;]
  [Domain]
    type = ConstantTransportMaterial&lt;&lt;&lt;{&quot;description&quot;: &quot;Provides the particle group velocity ($v_{g}$), particle group total cross-section ($\\Sigma_{a,g}$), and the scattering cross-section moments ($\\Sigma_{s, g&#x27;, g, l}$) for transport problems. If no scattering cross-section moments are provided, the material initializes all moments to 0. The properties must be listed in decreasing order by energy.&quot;, &quot;href&quot;: &quot;../source/materials/ConstantTransportMaterial.html&quot;}&gt;&gt;&gt;
    transport_system&lt;&lt;&lt;{&quot;description&quot;: &quot;Name of the transport system which will consume the provided material properties. If one is not provided the first transport system will be used.&quot;}&gt;&gt;&gt; = Neutron
    anisotropy&lt;&lt;&lt;{&quot;description&quot;: &quot;The scattering anisotropy of the medium.&quot;}&gt;&gt;&gt; = 0
    group_total&lt;&lt;&lt;{&quot;description&quot;: &quot;The macroscopic particle total cross-sections for all energy groups.&quot;}&gt;&gt;&gt; = 2.0
    group_scattering&lt;&lt;&lt;{&quot;description&quot;: &quot;The group-to-group scattering cross-section moments for all energy groups.&quot;}&gt;&gt;&gt; = 1.0
  []
[]</code></pre><a class="moose-source-filename tooltipped modal-trigger" href="#83ae85a1-9667-454e-bbe3-84883ddcd7d1">(tutorials/2D_fixed_source/2D_point_source.i)</a><p>This declares a constant material which provides enough parameters for a single neutron group. The material provides an isotropic scattering cross section (<code>anisotropy = 0</code>). The material has an total cross section of 2 (<code>group_total = 2.0</code>) and a scattering cross section of 1 (<code>group_scattering = 1.0</code>). <code>transport_system = Neutron</code> links this material to the <code>Neutron</code> transport system previously declared.</p><p>The remainder of the input file describes how the problem should be solved:</p><pre class="moose-pre" style="max-height:350px;"><code class="language-moose">[Executioner]
  type = Steady
  solve_type = PJFNK
  petsc_options_iname = &#x27;-pc_type -pc_hypre_type -ksp_gmres_restart&#x27;
  petsc_options_value = &#x27; hypre    boomeramg      10&#x27;
  l_max_its = 50
  nl_rel_tol = 1e-12
[]</code></pre><a class="moose-source-filename tooltipped modal-trigger" href="#61ccac99-85e5-4076-ac27-963bbdbdafb8">(tutorials/2D_fixed_source/2D_point_source.i)</a><p>The <code>Executioner</code> block declares the solver parameters and solve type. In this case, <code>type = Steady</code> and the Preconditioned Jacobian-Free Newton Krylov (<code>solve_type = PJFNK</code>) is used. It is recommended that the user employ the PJFNK solver for continuous finite element methods when solving radiation transport problems with the SAAF-CFEM scheme.</p><p>The simulation can be executed with the following shell command:</p><pre class="moose-pre"><code class="language-bash">
mpiexec -np 2 gnat-opt -i ./2D_point_source.i --n-threads=2
</code></pre><p>The results of this simple case can be seen below in <a class="moose-float-reference" href="#point_output">Figure 2</a>:</p><div class="card moose-float" style="width:40%;margin-left:auto;margin-right:auto;halign:center" id="point_output"><div class="card-content"><picture class="materialboxed moose-image"><img src="../media/2D_fixed_source/1_group_point_source.png"></img></picture><p class="moose-caption"><span class="moose-caption-heading">Figure 2: </span><span class="moose-caption-text" id="point_output">Scalar flux from the 2D point source problem.</span></p></div></div><p>We can see the signature disadvantage of the discrete ordiantes method: ray effects. These occur because of the limited angular resolution (four directions per quadrant of the 2D unit sphere) of the chosen discretization compared to the small size of the fixed source. We can attempt to mitigate these ray effects by adding extra directions by specifying <code>n_azimuthal = 10</code> and <code>n_polar = 10</code>, which results in <a href="#point_output_ref">Figure 3</a>.</p><div class="card moose-float" style="width:40%;margin-left:auto;margin-right:auto;halign:center" id="point_output_ref"><div class="card-content"><picture class="materialboxed moose-image"><img src="../media/2D_fixed_source/1_group_point_source_ref.png"></img></picture><p class="moose-caption"><span class="moose-caption-heading">Figure 3: </span><span class="moose-caption-text" id="point_output_ref">Refined scalar flux from the 2D point source problem.</span></p></div></div><p>However, the increased angular fidelity results in a large increase in runtime with diminishing returns. Instead of increasing the number of directions one could instead use an uncollided flux technique, which is discussed in the <a href="uncollided_flux.html">uncollided flux tutorial</a>.</p></section><section class="scrollspy" id="46cca55d-cfc9-4d8a-a434-41d13d5a2e9f" data-section-level="2" data-section-text="Adding a Second Energy Group"><h2 id="adding-a-second-energy-group">Adding a Second Energy Group</h2><p>In this section, we modify the problem to add a second energy group. The modifications made to the transport system can be found below.</p><pre class="moose-pre" style="max-height:350px;"><code class="language-moose">[TransportSystems&lt;&lt;&lt;{&quot;href&quot;: &quot;../syntax/TransportSystems/index.html&quot;}&gt;&gt;&gt;]
  [Neutron]
    num_groups&lt;&lt;&lt;{&quot;description&quot;: &quot;The number of spectral energy groups in the problem.&quot;}&gt;&gt;&gt; = 2
    max_anisotropy&lt;&lt;&lt;{&quot;description&quot;: &quot;The maximum degree of anisotropy to evaluate. Defaults to 0 for isotropic scattering.&quot;}&gt;&gt;&gt; = 0
    scheme&lt;&lt;&lt;{&quot;description&quot;: &quot;The discretization and stabilization scheme for the transport equation.&quot;}&gt;&gt;&gt; = saaf_cfem
    particle_type&lt;&lt;&lt;{&quot;description&quot;: &quot;The type of particle to be consuming material property data.&quot;}&gt;&gt;&gt; = neutron

    order&lt;&lt;&lt;{&quot;description&quot;: &quot;Specifies the order of the FE shape function to use for this variable (additional orders not listed are allowed).&quot;}&gt;&gt;&gt; = FIRST
    family&lt;&lt;&lt;{&quot;description&quot;: &quot;Specifies the family of FE shape functions to use for this variable.&quot;}&gt;&gt;&gt; = LAGRANGE

    n_azimuthal&lt;&lt;&lt;{&quot;description&quot;: &quot;Number of Chebyshev azimuthal quadrature points in a single octant of the unit sphere. Defaults to 3.&quot;}&gt;&gt;&gt; = 2
    n_polar&lt;&lt;&lt;{&quot;description&quot;: &quot;Number of Legendre polar quadrature points in a single octant of the unit sphere. Defaults to 3.&quot;}&gt;&gt;&gt; = 2

    vacuum_boundaries&lt;&lt;&lt;{&quot;description&quot;: &quot;The boundaries to apply vacuum boundary conditions.&quot;}&gt;&gt;&gt; = &#x27;left right top bottom&#x27;

    point_source_locations&lt;&lt;&lt;{&quot;description&quot;: &quot;The locations of all isotropic point sources in the problem space.&quot;}&gt;&gt;&gt; = &#x27;5.0 5.0 0.0&#x27;
    point_source_moments&lt;&lt;&lt;{&quot;description&quot;: &quot;A double vector containing a list of external source moments for all point particle sources. The external vector should correspond with the order of &#x27;point_source_locations&#x27;.&quot;}&gt;&gt;&gt; = &#x27;1e3 1.0&#x27;
    point_source_anisotropies&lt;&lt;&lt;{&quot;description&quot;: &quot;The anisotropies of the point sources. The vector should correspond with the order of &#x27;point_source_locations&#x27;&quot;}&gt;&gt;&gt; = &#x27;0&#x27;
    scale_sources&lt;&lt;&lt;{&quot;description&quot;: &quot;If the external fixed sources should be scaled such that each source moment is divided by the maximum source moment.&quot;}&gt;&gt;&gt; = true
  []
[]</code></pre><a class="moose-source-filename tooltipped modal-trigger" href="#d2bc4605-b043-4fef-94f8-160ab4c84a8d">(tutorials/2D_fixed_source/2D_point_source_2_grp.i)</a><p>We specify that two energy groups should be added by setting <code>num_groups = 2</code>. We then add a second source moment for the point source with <code>point_source_moments = &#x27;1e3 1.0&#x27;</code>. The <code>TransportMaterials</code> block then needs to be modified with a new set of group properties.</p><pre class="moose-pre" style="max-height:350px;"><code class="language-moose">[TransportMaterials&lt;&lt;&lt;{&quot;href&quot;: &quot;../syntax/TransportMaterials/index.html&quot;}&gt;&gt;&gt;]
  [Domain]
    type = ConstantTransportMaterial&lt;&lt;&lt;{&quot;description&quot;: &quot;Provides the particle group velocity ($v_{g}$), particle group total cross-section ($\\Sigma_{a,g}$), and the scattering cross-section moments ($\\Sigma_{s, g&#x27;, g, l}$) for transport problems. If no scattering cross-section moments are provided, the material initializes all moments to 0. The properties must be listed in decreasing order by energy.&quot;, &quot;href&quot;: &quot;../source/materials/ConstantTransportMaterial.html&quot;}&gt;&gt;&gt;
    transport_system&lt;&lt;&lt;{&quot;description&quot;: &quot;Name of the transport system which will consume the provided material properties. If one is not provided the first transport system will be used.&quot;}&gt;&gt;&gt; = Neutron
    anisotropy&lt;&lt;&lt;{&quot;description&quot;: &quot;The scattering anisotropy of the medium.&quot;}&gt;&gt;&gt; = 0
    group_total&lt;&lt;&lt;{&quot;description&quot;: &quot;The macroscopic particle total cross-sections for all energy groups.&quot;}&gt;&gt;&gt; = &#x27;1.0 2.0&#x27;
    group_scattering&lt;&lt;&lt;{&quot;description&quot;: &quot;The group-to-group scattering cross-section moments for all energy groups.&quot;}&gt;&gt;&gt; = &#x27;0.4 0.1
                        0.0 2.0&#x27;
  []
[]</code></pre><a class="moose-source-filename tooltipped modal-trigger" href="#422ff345-9d71-4a78-b509-e6f7561fbaeb">(tutorials/2D_fixed_source/2D_point_source_2_grp.i)</a><p>Here, we modify the total cross section such that it&#x27;s representative of two-group transport in a highly scattering material (such as water). The scattering cross section becomes a scattering matrix with zero thermal upscattering. This modified input deck can be run with:</p><pre class="moose-pre"><code class="language-bash">
mpiexec -np 2 gnat-opt -i ./2D_point_source_2_grp.i --n-threads=2
</code></pre><p>The results for group 1 (fast) can be found in <a href="#2g_point_g1">Figure 4</a>, while the results for group 2 (thermal) can be found in <a href="#2g_point_g2">Figure 5</a>.</p><div class="row" style="display:inline-flex;"><div class="col s12 m12 l12"><div class="card moose-float" style="width:100%;margin-left:auto;margin-right:auto;halign:center" id="2g_point_g1"><div class="card-content"><picture class="materialboxed moose-image"><img src="../media/2D_fixed_source/2_group_point_source_g1.png"></img></picture><p class="moose-caption"><span class="moose-caption-heading">Figure 4: </span><span class="moose-caption-text" id="2g_point_g1">Group 1 scalar flux from the 2D point source problem.</span></p></div></div><p></p></div><div class="col s12 m12 l12"><div class="card moose-float" style="width:100%;margin-left:auto;margin-right:auto;halign:center" id="2g_point_g2"><div class="card-content"><picture class="materialboxed moose-image"><img src="../media/2D_fixed_source/2_group_point_source_g2.png"></img></picture><p class="moose-caption"><span class="moose-caption-heading">Figure 5: </span><span class="moose-caption-text" id="2g_point_g2">Group 2 scalar flux from the 2D point source problem.</span></p></div></div><p></p></div><p></p></div><p>Similar to <a href="#point_output">Figure 2</a>, we can see ray effects in the fast energy group due to the low within-group scattering cross section relative to the total cross section. The effect of fast-to-thermal scattering and the large within-group thermal scattering cross section can be seen in <a href="#2g_point_g2">Figure 5</a>, where there are no ray effect even though the point source emits into group two.</p></section><section class="scrollspy" id="baefd26f-d273-46ff-a8f0-49ade3a7d127" data-section-level="2" data-section-text="Swapping the Point Source for a Surface Source"><h2 id="swapping-the-point-source-for-a-surface-source">Swapping the Point Source for a Surface Source</h2><p>In this section, we remove the point source and add an isotropic surface source on the top boundary of the domain. This requires a few minor modifications to the <code>TransportSystem</code>.</p><pre class="moose-pre" style="max-height:350px;"><code class="language-moose">[TransportSystems&lt;&lt;&lt;{&quot;href&quot;: &quot;../syntax/TransportSystems/index.html&quot;}&gt;&gt;&gt;]
  [Neutron]
    num_groups&lt;&lt;&lt;{&quot;description&quot;: &quot;The number of spectral energy groups in the problem.&quot;}&gt;&gt;&gt; = 2
    max_anisotropy&lt;&lt;&lt;{&quot;description&quot;: &quot;The maximum degree of anisotropy to evaluate. Defaults to 0 for isotropic scattering.&quot;}&gt;&gt;&gt; = 0
    scheme&lt;&lt;&lt;{&quot;description&quot;: &quot;The discretization and stabilization scheme for the transport equation.&quot;}&gt;&gt;&gt; = saaf_cfem
    particle_type&lt;&lt;&lt;{&quot;description&quot;: &quot;The type of particle to be consuming material property data.&quot;}&gt;&gt;&gt; = neutron

    order&lt;&lt;&lt;{&quot;description&quot;: &quot;Specifies the order of the FE shape function to use for this variable (additional orders not listed are allowed).&quot;}&gt;&gt;&gt; = FIRST
    family&lt;&lt;&lt;{&quot;description&quot;: &quot;Specifies the family of FE shape functions to use for this variable.&quot;}&gt;&gt;&gt; = LAGRANGE

    n_azimuthal&lt;&lt;&lt;{&quot;description&quot;: &quot;Number of Chebyshev azimuthal quadrature points in a single octant of the unit sphere. Defaults to 3.&quot;}&gt;&gt;&gt; = 2
    n_polar&lt;&lt;&lt;{&quot;description&quot;: &quot;Number of Legendre polar quadrature points in a single octant of the unit sphere. Defaults to 3.&quot;}&gt;&gt;&gt; = 2

    vacuum_boundaries&lt;&lt;&lt;{&quot;description&quot;: &quot;The boundaries to apply vacuum boundary conditions.&quot;}&gt;&gt;&gt; = &#x27;left right bottom&#x27;
    source_boundaries&lt;&lt;&lt;{&quot;description&quot;: &quot;The boundaries to apply incoming flux boundary conditions.&quot;}&gt;&gt;&gt; = &#x27;top&#x27;

    boundary_source_moments&lt;&lt;&lt;{&quot;description&quot;: &quot;A double vector containing the external source moments for all boundaries. The exterior vector must correspond with the surface source boundary conditions provided in &#x27;source_boundaries&#x27;.&quot;}&gt;&gt;&gt; = &#x27;1e3 1.0&#x27;
    boundary_source_anisotropy&lt;&lt;&lt;{&quot;description&quot;: &quot;The degree of anisotropy of the boundary source moments. The exterior vector must correspond with the surface source boundary conditions provided in &#x27;source_boundaries&#x27;.&quot;}&gt;&gt;&gt; = &#x27;0&#x27;
    scale_sources&lt;&lt;&lt;{&quot;description&quot;: &quot;If the external fixed sources should be scaled such that each source moment is divided by the maximum source moment.&quot;}&gt;&gt;&gt; = true
  []
[]</code></pre><a class="moose-source-filename tooltipped modal-trigger" href="#4f1c7953-b1e6-4d3d-8828-bbb2c154995b">(tutorials/2D_fixed_source/2D_surface_source_2_grp.i)</a><p><code>point_source_locations</code> is replaced with <code>source_boundaries</code>, which contains the side sets on which we wish to apply the surface source. <code>point_source_moments</code> and <code>point_source_anisotropies</code> are then replaced with their surface source equivalents: <code>boundary_source_moments</code> and <code>boundary_source_anisotropy</code>. This modified input deck can be run with:</p><pre class="moose-pre"><code class="language-bash">
mpiexec -np 2 gnat-opt -i ./2D_surface_source_2_grp.i --n-threads=2
</code></pre><p>The results for group 1 (fast) can be found in <a href="#2g_surf_g1">Figure 6</a>, while the results for group 2 (thermal) can be found in <a href="#2g_surf_g2">Figure 7</a>.</p><div class="row" style="display:inline-flex;"><div class="col s12 m12 l12"><div class="card moose-float" style="width:100%;margin-left:auto;margin-right:auto;halign:center" id="2g_surf_g1"><div class="card-content"><picture class="materialboxed moose-image"><img src="../media/2D_fixed_source/2_group_surface_source_g1.png"></img></picture><p class="moose-caption"><span class="moose-caption-heading">Figure 6: </span><span class="moose-caption-text" id="2g_surf_g1">Group 1 scalar flux from the 2D surface source problem.</span></p></div></div><p></p></div><div class="col s12 m12 l12"><div class="card moose-float" style="width:100%;margin-left:auto;margin-right:auto;halign:center" id="2g_surf_g2"><div class="card-content"><picture class="materialboxed moose-image"><img src="../media/2D_fixed_source/2_group_surface_source_g2.png"></img></picture><p class="moose-caption"><span class="moose-caption-heading">Figure 7: </span><span class="moose-caption-text" id="2g_surf_g2">Group 2 scalar flux from the 2D surface source problem.</span></p></div></div><p></p></div><p></p></div></section></section><div class="moose-modal modal" id="68e0d15f-c10b-4a81-88e4-0ca5960a365d"><div class="modal-content"><h4>(tutorials/2D_fixed_source/2D_point_source.i)</h4><pre class="moose-pre"><code class="language-moose"># A simple test case with a single group scattering medium and a point source
# in the middle of the domain.

[Mesh]
  [domain]
    type = CartesianMeshGenerator
    dim = 2
    dx = 10
    dy = 10
    ix = 101
    iy = 101
  []
[]

[TransportSystems]
  [Neutron]
    num_groups = 1
    max_anisotropy = 0
    scheme = saaf_cfem
    particle_type = neutron

    order = FIRST
    family = LAGRANGE

    n_azimuthal = 2
    n_polar = 2

    vacuum_boundaries = &#x27;left right top bottom&#x27;

    point_source_locations = &#x27;5.0 5.0 0.0&#x27;
    point_source_moments = &#x27;1e3&#x27;
    point_source_anisotropies = &#x27;0&#x27;
    scale_sources = true
  []
[]

[TransportMaterials]
  [Domain]
    type = ConstantTransportMaterial
    transport_system = Neutron
    anisotropy = 0
    group_total = 2.0
    group_scattering = 1.0
  []
[]

[Executioner]
  type = Steady
  solve_type = PJFNK
  petsc_options_iname = &#x27;-pc_type -pc_hypre_type -ksp_gmres_restart&#x27;
  petsc_options_value = &#x27; hypre    boomeramg      10&#x27;
  l_max_its = 50
  nl_rel_tol = 1e-12
[]

[Outputs]
  exodus = true
  execute_on = &#x27;TIMESTEP_END&#x27;
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="moose-modal modal" id="82ab96e4-bca5-44f0-a8e2-321a2bb44ab5"><div class="modal-content"><h4>(tutorials/2D_fixed_source/2D_point_source.i)</h4><pre class="moose-pre"><code class="language-moose"># A simple test case with a single group scattering medium and a point source
# in the middle of the domain.

[Mesh]
  [domain]
    type = CartesianMeshGenerator
    dim = 2
    dx = 10
    dy = 10
    ix = 101
    iy = 101
  []
[]

[TransportSystems]
  [Neutron]
    num_groups = 1
    max_anisotropy = 0
    scheme = saaf_cfem
    particle_type = neutron

    order = FIRST
    family = LAGRANGE

    n_azimuthal = 2
    n_polar = 2

    vacuum_boundaries = &#x27;left right top bottom&#x27;

    point_source_locations = &#x27;5.0 5.0 0.0&#x27;
    point_source_moments = &#x27;1e3&#x27;
    point_source_anisotropies = &#x27;0&#x27;
    scale_sources = true
  []
[]

[TransportMaterials]
  [Domain]
    type = ConstantTransportMaterial
    transport_system = Neutron
    anisotropy = 0
    group_total = 2.0
    group_scattering = 1.0
  []
[]

[Executioner]
  type = Steady
  solve_type = PJFNK
  petsc_options_iname = &#x27;-pc_type -pc_hypre_type -ksp_gmres_restart&#x27;
  petsc_options_value = &#x27; hypre    boomeramg      10&#x27;
  l_max_its = 50
  nl_rel_tol = 1e-12
[]

[Outputs]
  exodus = true
  execute_on = &#x27;TIMESTEP_END&#x27;
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="moose-modal modal" id="83ae85a1-9667-454e-bbe3-84883ddcd7d1"><div class="modal-content"><h4>(tutorials/2D_fixed_source/2D_point_source.i)</h4><pre class="moose-pre"><code class="language-moose"># A simple test case with a single group scattering medium and a point source
# in the middle of the domain.

[Mesh]
  [domain]
    type = CartesianMeshGenerator
    dim = 2
    dx = 10
    dy = 10
    ix = 101
    iy = 101
  []
[]

[TransportSystems]
  [Neutron]
    num_groups = 1
    max_anisotropy = 0
    scheme = saaf_cfem
    particle_type = neutron

    order = FIRST
    family = LAGRANGE

    n_azimuthal = 2
    n_polar = 2

    vacuum_boundaries = &#x27;left right top bottom&#x27;

    point_source_locations = &#x27;5.0 5.0 0.0&#x27;
    point_source_moments = &#x27;1e3&#x27;
    point_source_anisotropies = &#x27;0&#x27;
    scale_sources = true
  []
[]

[TransportMaterials]
  [Domain]
    type = ConstantTransportMaterial
    transport_system = Neutron
    anisotropy = 0
    group_total = 2.0
    group_scattering = 1.0
  []
[]

[Executioner]
  type = Steady
  solve_type = PJFNK
  petsc_options_iname = &#x27;-pc_type -pc_hypre_type -ksp_gmres_restart&#x27;
  petsc_options_value = &#x27; hypre    boomeramg      10&#x27;
  l_max_its = 50
  nl_rel_tol = 1e-12
[]

[Outputs]
  exodus = true
  execute_on = &#x27;TIMESTEP_END&#x27;
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="moose-modal modal" id="61ccac99-85e5-4076-ac27-963bbdbdafb8"><div class="modal-content"><h4>(tutorials/2D_fixed_source/2D_point_source.i)</h4><pre class="moose-pre"><code class="language-moose"># A simple test case with a single group scattering medium and a point source
# in the middle of the domain.

[Mesh]
  [domain]
    type = CartesianMeshGenerator
    dim = 2
    dx = 10
    dy = 10
    ix = 101
    iy = 101
  []
[]

[TransportSystems]
  [Neutron]
    num_groups = 1
    max_anisotropy = 0
    scheme = saaf_cfem
    particle_type = neutron

    order = FIRST
    family = LAGRANGE

    n_azimuthal = 2
    n_polar = 2

    vacuum_boundaries = &#x27;left right top bottom&#x27;

    point_source_locations = &#x27;5.0 5.0 0.0&#x27;
    point_source_moments = &#x27;1e3&#x27;
    point_source_anisotropies = &#x27;0&#x27;
    scale_sources = true
  []
[]

[TransportMaterials]
  [Domain]
    type = ConstantTransportMaterial
    transport_system = Neutron
    anisotropy = 0
    group_total = 2.0
    group_scattering = 1.0
  []
[]

[Executioner]
  type = Steady
  solve_type = PJFNK
  petsc_options_iname = &#x27;-pc_type -pc_hypre_type -ksp_gmres_restart&#x27;
  petsc_options_value = &#x27; hypre    boomeramg      10&#x27;
  l_max_its = 50
  nl_rel_tol = 1e-12
[]

[Outputs]
  exodus = true
  execute_on = &#x27;TIMESTEP_END&#x27;
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="moose-modal modal" id="d2bc4605-b043-4fef-94f8-160ab4c84a8d"><div class="modal-content"><h4>(tutorials/2D_fixed_source/2D_point_source_2_grp.i)</h4><pre class="moose-pre"><code class="language-moose"># A simple test case with a single group scattering medium and a point source
# in the middle of the domain.

[Mesh]
  [domain]
    type = CartesianMeshGenerator
    dim = 2
    dx = 10
    dy = 10
    ix = 101
    iy = 101
  []
[]

[TransportSystems]
  [Neutron]
    num_groups = 2
    max_anisotropy = 0
    scheme = saaf_cfem
    particle_type = neutron

    order = FIRST
    family = LAGRANGE

    n_azimuthal = 2
    n_polar = 2

    vacuum_boundaries = &#x27;left right top bottom&#x27;

    point_source_locations = &#x27;5.0 5.0 0.0&#x27;
    point_source_moments = &#x27;1e3 1.0&#x27;
    point_source_anisotropies = &#x27;0&#x27;
    scale_sources = true
  []
[]

[TransportMaterials]
  [Domain]
    type = ConstantTransportMaterial
    transport_system = Neutron
    anisotropy = 0
    group_total = &#x27;1.0 2.0&#x27;
    group_scattering = &#x27;0.4 0.1
                        0.0 2.0&#x27;
  []
[]

[Executioner]
  type = Steady
  solve_type = PJFNK
  petsc_options_iname = &#x27;-pc_type -pc_hypre_type -ksp_gmres_restart&#x27;
  petsc_options_value = &#x27; hypre    boomeramg      10&#x27;
  l_max_its = 50
  nl_rel_tol = 1e-12
[]

[Outputs]
  exodus = true
  execute_on = &#x27;TIMESTEP_END&#x27;
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="moose-modal modal" id="422ff345-9d71-4a78-b509-e6f7561fbaeb"><div class="modal-content"><h4>(tutorials/2D_fixed_source/2D_point_source_2_grp.i)</h4><pre class="moose-pre"><code class="language-moose"># A simple test case with a single group scattering medium and a point source
# in the middle of the domain.

[Mesh]
  [domain]
    type = CartesianMeshGenerator
    dim = 2
    dx = 10
    dy = 10
    ix = 101
    iy = 101
  []
[]

[TransportSystems]
  [Neutron]
    num_groups = 2
    max_anisotropy = 0
    scheme = saaf_cfem
    particle_type = neutron

    order = FIRST
    family = LAGRANGE

    n_azimuthal = 2
    n_polar = 2

    vacuum_boundaries = &#x27;left right top bottom&#x27;

    point_source_locations = &#x27;5.0 5.0 0.0&#x27;
    point_source_moments = &#x27;1e3 1.0&#x27;
    point_source_anisotropies = &#x27;0&#x27;
    scale_sources = true
  []
[]

[TransportMaterials]
  [Domain]
    type = ConstantTransportMaterial
    transport_system = Neutron
    anisotropy = 0
    group_total = &#x27;1.0 2.0&#x27;
    group_scattering = &#x27;0.4 0.1
                        0.0 2.0&#x27;
  []
[]

[Executioner]
  type = Steady
  solve_type = PJFNK
  petsc_options_iname = &#x27;-pc_type -pc_hypre_type -ksp_gmres_restart&#x27;
  petsc_options_value = &#x27; hypre    boomeramg      10&#x27;
  l_max_its = 50
  nl_rel_tol = 1e-12
[]

[Outputs]
  exodus = true
  execute_on = &#x27;TIMESTEP_END&#x27;
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="moose-modal modal" id="4f1c7953-b1e6-4d3d-8828-bbb2c154995b"><div class="modal-content"><h4>(tutorials/2D_fixed_source/2D_surface_source_2_grp.i)</h4><pre class="moose-pre"><code class="language-moose"># A simple test case with a single group scattering medium and a point source
# in the middle of the domain.

[Mesh]
  [domain]
    type = CartesianMeshGenerator
    dim = 2
    dx = 10
    dy = 10
    ix = 101
    iy = 101
  []
[]

[TransportSystems]
  [Neutron]
    num_groups = 2
    max_anisotropy = 0
    scheme = saaf_cfem
    particle_type = neutron

    order = FIRST
    family = LAGRANGE

    n_azimuthal = 2
    n_polar = 2

    vacuum_boundaries = &#x27;left right bottom&#x27;
    source_boundaries = &#x27;top&#x27;

    boundary_source_moments = &#x27;1e3 1.0&#x27;
    boundary_source_anisotropy = &#x27;0&#x27;
    scale_sources = true
  []
[]

[TransportMaterials]
  [Domain]
    type = ConstantTransportMaterial
    transport_system = Neutron
    anisotropy = 0
    group_total = &#x27;1.0 2.0&#x27;
    group_scattering = &#x27;0.4 0.1
                        0.0 2.0&#x27;
  []
[]

[Executioner]
  type = Steady
  solve_type = PJFNK
  petsc_options_iname = &#x27;-pc_type -pc_hypre_type -ksp_gmres_restart&#x27;
  petsc_options_value = &#x27; hypre    boomeramg      10&#x27;
  l_max_its = 50
  nl_rel_tol = 1e-12
[]

[Outputs]
  exodus = true
  execute_on = &#x27;TIMESTEP_END&#x27;
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div></div><div class="col hide-on-med-and-down l2"><div class="toc-wrapper pin-top"><ul class="section table-of-contents"><li><a href="#bcef042a-8f8b-47c5-8042-a7376307d947" class="tooltipped" data-position="left" data-tooltip="Geometry and Material Properties">Geometry and Material Properties</a></li><li><a href="#5ce259cb-86bd-458f-8ee7-e71f56aecfbf" class="tooltipped" data-position="left" data-tooltip="The Neutronics Input File">The Neutronics Input File</a></li><li><a href="#46cca55d-cfc9-4d8a-a434-41d13d5a2e9f" class="tooltipped" data-position="left" data-tooltip="Adding a Second Energy Group">Adding a Second Energy Group</a></li><li><a href="#baefd26f-d273-46ff-a8f0-49ade3a7d127" class="tooltipped" data-position="left" data-tooltip="Swapping the Point Source for a Surface Source">Swapping the Point Source for a Surface Source</a></li></ul></div></div></div></div></main></div></body><script type="text/javascript" src="../contrib/materialize/materialize.min.js"></script><script type="text/javascript" src="../contrib/clipboard/clipboard.min.js"></script><script type="text/javascript" src="../contrib/prism/prism.min.js"></script><script type="text/javascript" src="../js/init.js"></script><script type="text/javascript" src="../js/navigation.js"></script><script type="text/javascript" src="../contrib/fuse/fuse.min.js"></script><script type="text/javascript" src="../js/search_index.js"></script><script type="text/javascript" src="../js/sqa_moose.js"></script><script type="text/javascript" src="../js/moose_input_parser.js"></script>